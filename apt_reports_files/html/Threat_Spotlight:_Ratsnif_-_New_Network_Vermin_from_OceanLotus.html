<!DOCTYPE HTML>
<html lang="en">
    <head>
    <meta charset="UTF-8"/>

    
    









    <!-- OneTrust Cookies Consent Notice Start -->






    <script src="https://cdn.cookielaw.org/scripttemplates/otSDKStub.js" data-document-language="true" type="text/javascript" charset="UTF-8" data-domain-script="6373c986-7725-4c54-9731-2a91bdd43107"></script>


<script type="text/javascript">
    function OptanonWrapper() { }
</script>

<!-- OneTrust Cookies Consent Notice End -->

















    
    
    <title>Threat Spotlight: Ratsnif - New Network Vermin from OceanLotus</title>
    

<script type="application/ld+json">
    {
        "@context": "https://schema.org",
        "@type": "NewsArticle",
        "mainEntityOfPage": {
            "@type": "WebPage",
            "@id": "https://blogs.blackberry.com/en/2019/07/threat-spotlight-ratsnif-new-network-vermin-from-oceanlotus"
        },
        "headline": "Threat Spotlight: Ratsnif - New Network Vermin from OceanLotus",
        "image": [
            "/content/dam/blogs-blackberry-com/images/category/research-thumbnail-350x350-b.jpg",
            "/content/dam/blogs-blackberry-com/images/blogs/2019/07/190619-oceanlotus-ratsnif-1-lrg.jpg"
        ],
        "datePublished": "2019-07-01T13:13:00.000-07:00",
        "author": {
                    "@type": "Person",
                    "name": "The BlackBerry Cylance Threat Research Team"
                },

        "publisher": {
            "@type": "Organization",
            "name": "BlackBerry",
            "logo": {
                "@type": "ImageObject",
                "url": "https://blogs.blackberry.com/content/dam/blackberry-com/Images/logos/BlackBerry_Logo_Black_150.png"
            }
        }
    }
</script>

    <meta name="keywords" content="Cybersecurity"/>
    <meta name="description" content="The OceanLotus Group (aka APT32, CobaltKitty) is using a suite of remote access trojans dubbed &#39;Ratsnif&#39; to leverage new network attack capabilities. In this blog, BlackBerry Cylance threat researchers have analyzed the Ratsnif trojans, which offer a veritable Swiss-army knife of network attack techniques."/>
    
    <link rel="icon" href="/etc.clientlibs/bbcom/clientlibs/clientlib-etc-legacy/resources/bbcom-aem-project/images/favicon.ico"/>
    <meta name="viewport" content="width=device-width, initial-scale=1"/>
    <meta http-equiv="X-UA-Compatible" content="IE=edge"/>
    
    
    
    <link rel="canonical" href="https://blogs.blackberry.com/en/2019/07/threat-spotlight-ratsnif-new-network-vermin-from-oceanlotus"/>
    <meta name="author" content="blogs.blackberry.com"/>
    <meta property="og:url" content="https://blogs.blackberry.com/en/2019/07/threat-spotlight-ratsnif-new-network-vermin-from-oceanlotus"/>
    <meta property="og:title" content="Threat Spotlight: Ratsnif - New Network Vermin from OceanLotus"/>
    <meta property="og:description" content="The OceanLotus Group (aka APT32, CobaltKitty) is using a suite of remote access trojans dubbed &#39;Ratsnif&#39; to leverage new network attack capabilities. In this blog, BlackBerry Cylance threat researchers have analyzed the Ratsnif trojans, which offer a veritable Swiss-army knife of network attack techniques."/>
    <meta property="og:type" content="article"/>
    <meta property="og:image" content="https://blogs.blackberry.com/content/dam/blogs-blackberry-com/images/blogs/2019/07/190619-oceanlotus-ratsnif-1-lrg.jpg"/>
    <meta name="twitter:card" content="summary_large_image"/>
    <meta name="twitter:site" content="@BlackBerry"/>
    <meta name="twitter:title" content="Threat Spotlight: Ratsnif - New Network Vermin from OceanLotus"/>
    <meta name="twitter:description" content="The OceanLotus Group (aka APT32, CobaltKitty) is using a suite of remote access trojans dubbed &#39;Ratsnif&#39; to leverage new network attack capabilities. In this blog, BlackBerry Cylance threat researchers have analyzed the Ratsnif trojans, which offer a veritable Swiss-army knife of network attack techniques."/>
    <meta name="twitter:image" content="https://blogs.blackberry.com/content/dam/blogs-blackberry-com/images/blogs/2019/07/190619-oceanlotus-ratsnif-1-lrg.jpg"/>

    

    
    
<link rel="stylesheet" href="/etc.clientlibs/blogs-bbcom/clientlibs/clientlib-site.min.212090aa91e144ce76b952f074e6c1ba.css" type="text/css">





    








<script>
    var digitalData = {
        page: {
            pageInfo: {
                pageTitle: "Threat Spotlight: Ratsnif - New Network Vermin from OceanLotus",
                pageName: "en:2019:07:threat-spotlight-ratsnif-new-network-vermin-from-oceanlotus",
                domain:"blogs.blackberry.com",
                hierarchy:["en","2019","07","threat-spotlight-ratsnif-new-network-vermin-from-oceanlotus"],
                timeStamp:"2023-11-23 21:24:54",
                tags:"Cybersecurity",
                country:"GB"
            }
        }
    }
</script>



    <script src="//assets.adobedtm.com/cb3160b9e813/dd47d4a7a48e/launch-17c42c38011b.min.js" async></script>
    










<script>
    digitalData.blogPost = {
        authors: "The BlackBerry Cylance Threat Research Team",
        categories: "Research & Intelligence"
    }
</script>








    
    
        <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
})(window,document,'script','dataLayer','GTM-TXGFP23');</script>


<script async src="https://www.googletagmanager.com/gtag/js?id=AW-944900006"></script> 
<script> 
  window.dataLayer = window.dataLayer || []; 
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date()); gtag('config', 'AW-944900006'); 
</script>


<noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-TXGFP23" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>



    

    



<script src="https://kit.fontawesome.com/3c243f8233.js" crossorigin="anonymous"></script>

    
    
    

    
    
    
    

    
</head>
    <body class="page basicpage" data-enable-history="true">
        
        
            



            

  
<!--
<sly data-sly-use.templatedContainer="com.day.cq.wcm.foundation.TemplatedContainer"
   data-sly-repeat.child=""
   data-sly-resource=""/>
-->

<header>
    




    
    
    
<!-- BEGIN DO NOT INDEX -->

    

<!-- skip to content: START -->
<a href='#' class='skipNav' tabindex="0">Skip Navigation</a>
<!-- skip to content: END-->
<!-- BEGIN DO NOT INDEX -->

  <nav class="blogs-navigationv2 bb-blogs-navbar navbar navbar-expand-lg navbar-dark bg-dark">
    <div class="container">
      <a class="navbar-brand" href="https://blogs.blackberry.com">
        <svg width="175px" height="30px" viewBox="0 0 175 30" version="1.1">
          <title>BlackBerry Logo</title>
          <g id="Creative" stroke="none" strokeWidth="1" fill="none" fillRule="evenodd">
              <g id="21-product-page-Protect-02.15.22" transform="translate(-91.000000, -10.000000)" fill="#FFFFFF" fillRule="nonzero">
                  <g id="BB_White" transform="translate(91.000000, 10.000000)">
                      <path d="M9.18042011,2.14285967 C9.18042011,1.19318021 8.5959918,-1.17624431e-15 6.16086942,-1.17624431e-15 C5.16247216,-1.17624431e-15 2.4107723,-1.17624431e-15 2.4107723,-1.17624431e-15 L1.33931598,4.94318021 C1.33931598,4.94318021 3.36046941,4.94318021 5.25986363,4.94318021 C8.32813214,4.91883014 9.18042011,3.48214033 9.18042011,2.14285967 Z" id="Shape"></path>
                      <path d="M19.2861873,2.14285967 C19.2861873,1.19318021 18.701759,-1.17624431e-15 16.2666366,-1.17624431e-15 C15.2682393,-1.17624431e-15 12.5165395,-1.17624431e-15 12.5165395,-1.17624431e-15 L11.4450831,4.94318021 C11.4450831,4.94318021 13.4662366,4.94318021 15.3412807,4.94318021 C18.4338993,4.91883014 19.2861873,3.48214033 19.2861873,2.14285967 Z" id="Shape_1_"></path>
                      <path d="M7.84110413,9.54545936 C7.84110413,8.59578874 7.25667582,7.4025997 4.82155344,7.4025997 C3.82315617,7.4025997 1.07145632,7.4025997 1.07145632,7.4025997 L5.68518084e-15,12.3457799 C5.68518084e-15,12.3457799 2.02115343,12.3457799 3.89619757,12.3457799 C6.96445725,12.3457799 7.84110413,10.88474 7.84110413,9.54545936 Z" id="Shape_2_"></path>
                      <path d="M17.9468713,9.54545936 C17.9468713,8.59578874 17.362443,7.4025997 14.9273206,7.4025997 C13.9289233,7.4025997 11.1772235,7.4025997 11.1772235,7.4025997 L10.1057671,12.3457799 C10.1057671,12.3457799 12.1269206,12.3457799 14.0263148,12.3457799 C17.0702244,12.3457799 17.9468713,10.88474 17.9468713,9.54545936 Z" id="Shape_3_"></path>
                      <path d="M28.5153164,6.55032938 C28.5153164,5.60064992 27.930888,4.40746971 25.4957657,4.40746971 C24.4973684,4.40746971 21.7456774,4.40746971 21.7456774,4.40746971 L20.6742211,9.35064992 C20.6742211,9.35064992 22.6953745,9.35064992 24.5704186,9.35064992 C27.6386695,9.32629985 28.5153164,7.88961005 28.5153164,6.55032938 Z" id="Shape_4_"></path>
                      <path d="M27.0542412,14.2694801 C27.0542412,13.3198006 26.4698129,12.1266204 24.0346816,12.1266204 C23.0362844,12.1266204 20.2845934,12.1266204 20.2845934,12.1266204 L19.213137,17.0698006 C19.213137,17.0698006 21.2342905,17.0698006 23.1093346,17.0698006 C26.1775943,17.0698006 27.0542412,15.6087696 27.0542412,14.2694801 Z" id="Shape_5_"></path>
                      <path d="M16.4857961,17.2889601 C16.4857961,16.3392807 15.9013678,15.1461005 13.4662366,15.1461005 C12.4678393,15.1461005 9.71614827,15.1461005 9.71614827,15.1461005 L8.64469195,20.0892807 C8.64469195,20.0892807 10.6658454,20.0892807 12.5408895,20.0892807 C15.6091492,20.0649306 16.4857961,18.6282496 16.4857961,17.2889601 Z" id="Shape_6_"></path>
                      <path d="M83.7683052,18.75 C83.5978459,19.11526 82.7455491,20.7711005 80.6026453,20.7711005 C78.1188139,20.7711005 77.1447667,18.701291 77.1447667,17.191551 C77.1447667,14.6590813 78.8493515,12.3944712 81.3575329,12.3944712 C84.0605238,12.3944712 84.6936523,14.4155717 84.7667113,14.7808317 L88.7359591,14.7808317 C88.9794775,13.2954417 87.786262,8.74187154 81.5036422,8.74187154 C76.9012483,8.74187154 73.2242102,12.4188213 73.2242102,17.3133014 C73.2242102,21.331161 75.7323917,24.4236913 80.3834769,24.4236913 C86.1790775,24.4236913 87.7375619,19.8701212 87.9323713,18.7499912 L83.7683052,18.7499912 L83.7683052,18.75 Z" id="Shape_7_"></path>
                      <path d="M53.2805356,19.8457799 C53.2805356,19.6022703 53.3535858,19.1639601 53.5483953,18.2629897 C53.7432047,17.3376603 56.5435959,4.40746971 56.5435959,4.40746971 L52.8178577,4.40746971 L49.7252479,18.6769498 C49.6034887,19.2857193 49.5304385,19.87013 49.5304385,20.3814904 C49.5304385,23.4983708 51.9412108,24.4237002 53.889314,24.4237002 C54.5711514,24.4237002 55.22863,24.3019498 55.3747393,24.2775909 C55.4477895,23.961031 56.0322266,21.2824609 56.0565767,21.1607105 C55.9835265,21.1607105 55.5695487,21.2094107 55.0825295,21.2094107 C53.6945045,21.2094107 53.2805356,20.625 53.2805356,19.8457799 Z" id="Shape_8_"></path>
                      <polygon id="Shape_9_" points="106.220152 8.76623044 101.033339 8.76623044 94.3367415 14.7808405 96.6014133 4.38311963 92.8269661 4.38311963 88.5654909 24.1071403 92.3155881 24.1071403 93.3626943 19.3100606 95.6760575 17.4837696 98.8660763 24.1071403 103.054492 24.1071403 98.5251576 15.2435096"></polygon>
                      <path d="M32.7767827,18.0194801 C33.0933514,16.6071403 35.7232832,4.38311963 35.7232832,4.38311963 C35.7232832,4.38311963 40.2769681,4.38311963 42.8338497,4.38311963 C47.9963131,4.38311963 49.2625788,7.25649924 49.2625788,8.98538995 C49.2625788,12.8327903 45.6342409,13.8555199 45.1959219,13.9772703 C45.6098908,14.1233708 47.971963,15.0487002 47.971963,18.0681802 C47.971963,21.3555199 44.9524035,24.107459 40.2526181,24.107459 C40.2526181,24.107459 38.5723834,24.107459 38.1097143,24.107459 C34.1404576,24.1314904 32.0218951,21.4042201 32.7767827,18.0194801 Z M43.905306,17.7759705 C43.905306,16.8506411 43.2965277,15.681811 40.666587,15.681811 L37.2330585,15.681811 L36.2103112,20.4545406 L40.1065088,20.4545406 C42.5903401,20.4545406 43.905306,19.3100606 43.905306,17.7759705 Z M45.1715718,9.8133102 C45.1715718,8.86363075 44.4410342,8.0357105 42.6633904,8.0357105 L38.8645931,8.0357105 L38.0122963,12.0292201 L41.9815529,12.0292201 C44.0757654,12.0292201 45.1715718,10.9821403 45.1715718,9.8133102 Z" id="Shape_10_"></path>
                      <path d="M104.515568,18.0194801 C104.832136,16.6071403 107.462068,4.38311963 107.462068,4.38311963 C107.462068,4.38311963 112.015753,4.38311963 114.572626,4.38311963 C119.735089,4.38311963 121.001364,7.25649924 121.001364,8.98538995 C121.001364,12.8327903 117.373026,13.8555199 116.934707,13.9772703 C117.348667,14.1233708 119.710748,15.0487002 119.710748,18.0681802 C119.710748,21.3555199 116.666847,24.107459 111.991394,24.107459 C111.991394,24.107459 110.311159,24.107459 109.84849,24.107459 C105.879234,24.1314904 103.76068,21.4042201 104.515568,18.0194801 Z M115.644091,17.7759705 C115.644091,16.8506411 115.035304,15.681811 112.405372,15.681811 L108.947493,15.681811 L107.924737,20.4545406 L111.820935,20.4545406 C114.329125,20.4545406 115.644091,19.3100606 115.644091,17.7759705 Z M116.910348,9.8133102 C116.910348,8.86363075 116.17981,8.0357105 114.377825,8.0357105 L110.603378,8.0357105 L109.751081,12.0292201 L113.720347,12.0292201 C115.81455,12.0292201 116.910348,10.9821403 116.910348,9.8133102 Z" id="Shape_11_"></path>
                      <path d="M146.789339,8.76623044 C142.820083,8.76623044 140.092742,11.1282408 139.191745,15.5357105 C138.802126,17.4350606 137.365401,24.1071403 137.365401,24.1071403 L141.091139,24.1071403 C141.091139,24.1071403 142.454814,17.7516204 142.893133,15.75487 C143.45322,13.1493501 144.841236,12.2483796 146.69193,12.2483796 C147.300717,12.2483796 147.665986,12.3214298 147.860795,12.3457799 C147.958196,11.8100694 148.493915,9.44805023 148.615674,8.88798965 C148.226055,8.86363957 147.592918,8.76623044 146.789339,8.76623044 Z" id="Shape_12_"></path>
                      <path d="M159.451988,30 L171.968527,8.76623044 L167.950571,8.76623044 L162.20367,18.75 L160.864354,8.74188037 C160.864354,8.74188037 158.818851,8.74188037 156.554179,8.74188037 C151.610875,8.74188037 149.054002,11.0064904 148.153005,15.316551 C147.690327,17.4594107 146.253602,24.1071315 146.253602,24.1071315 L149.97934,24.1071315 C149.97934,24.1071315 151.343015,17.8003117 151.903085,15.2678508 C152.438822,12.8084314 154.265166,12.0535613 156.23761,12.4675303 L157.016848,8.83928067 C157.601285,12.2727209 159.378911,23.2792113 159.378911,23.2792113 L155.482714,30 L159.451988,30 L159.451988,30 Z" id="Shape_13_"></path>
                      <path d="M64.0437813,17.5811699 C64.871728,17.4594195 67.2581502,17.0941595 67.599069,17.0454594 C67.5260099,17.313319 67.4529597,17.7029291 67.3799095,18.0194889 C66.9415816,19.8701388 65.0665375,21.063319 62.972325,21.063319 C61.633009,21.063319 60.8537712,20.3571492 60.8537712,19.5048788 C60.8294212,18.7987002 61.4869085,17.9464298 64.0437813,17.5811699 Z M62.6314151,13.5876603 C62.7288242,13.4415598 63.6785213,11.9561699 66.0649435,11.9561699 C67.5503688,11.9561699 68.3052565,12.4918804 68.3052565,13.1493501 C68.3052565,14.0746706 66.8198312,14.3181802 64.2142406,14.6834402 C59.7579648,15.3165598 56.9332236,16.7045406 56.9332236,19.9188301 C56.9332236,22.2077903 58.8326178,24.4237002 62.193096,24.4237002 C64.9934872,24.4237002 66.4545624,22.7435096 66.5763216,22.5974003 C66.6006717,23.0113604 66.6493719,23.62013 66.6737308,24.1071403 C66.9902906,24.1071403 69.5715222,24.1071403 70.5212282,24.1071403 C70.399469,23.4496706 70.1072504,22.1590901 70.5699283,20.1136307 C70.8134379,19.0422009 71.4952754,15.9496706 71.8361941,14.24513 C72.4936815,11.0064904 70.7160376,8.74188037 66.1867116,8.74188037 C60.3424108,8.74188037 58.6621673,12.9301906 58.3943076,13.5876603 L62.6314151,13.5876603 Z" id="Shape_14_"></path>
                      <path d="M131.862019,19.5292201 C131.715918,19.8214298 130.814921,21.0876603 128.793759,21.0876603 C125.871617,21.0876603 125.214139,18.6038995 125.28718,17.9464298 C126.845665,17.9464298 135.831275,17.9464298 136.659213,17.9464298 C136.732272,17.6785702 136.975791,16.6558493 136.975791,15.6087696 C136.975791,12.00487 134.540668,8.71753912 129.621714,8.71753912 C125.11673,8.71753912 121.512742,12.4918892 121.512742,16.9967592 C121.512742,21.3311787 124.118324,24.423709 128.745059,24.423709 C134.443259,24.423709 135.977393,19.9675391 136.123494,19.5292289 C135.100738,19.5292201 131.862019,19.5292201 131.862019,19.5292201 Z M129.670406,12.1266204 C132.178587,12.1266204 133.128284,13.6607105 133.030884,14.8782408 C131.594159,14.8782408 127.308342,14.8782408 125.84725,14.8782408 C126.042068,14.0990295 127.235283,12.1266204 129.670406,12.1266204 Z" id="Shape_15_"></path>
                      <path d="M171.979978,19.5027334 C173.12535,19.5027334 174.087452,20.4108465 174.087452,21.6216668 C174.087452,22.8557689 173.10243,23.7406002 171.979978,23.7406002 C170.834615,23.7406002 169.849603,22.8324871 169.849603,21.6216668 C169.849603,20.4108465 170.834615,19.5027334 171.979978,19.5027334 Z M171.979978,19.8520043 C171.017877,19.8520043 170.26193,20.620409 170.26193,21.6216668 C170.26193,22.6462064 171.017877,23.4146111 171.979978,23.4146111 C172.942098,23.4146111 173.675125,22.6694882 173.675125,21.6216668 C173.675125,20.620409 172.919178,19.8520043 171.979978,19.8520043 Z M171.52183,22.8557689 L171.155316,22.8557689 L171.155316,20.4108465 L172.071613,20.4108465 C172.644299,20.4108465 172.919178,20.620409 172.919178,21.109397 C172.919178,21.5518126 172.644299,21.7380934 172.277768,21.7846569 L172.964991,22.8557689 L172.552655,22.8557689 L171.911246,21.7846569 L171.49891,21.7846569 L171.49891,22.8557689 L171.52183,22.8557689 Z M171.521821,21.4819585 L171.957076,21.4819585 C172.415225,21.4819585 172.552664,21.3422501 172.552664,21.0861152 C172.552664,20.8532621 172.438127,20.7135538 172.025792,20.7135538 L171.521821,20.7135538 L171.521821,21.4819585 L171.521821,21.4819585 Z" id="Shape_16_"></path>
                  </g>
              </g>
          </g>
      </svg>
      </a>
      <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
        <span class="navbar-toggler-icon"></span>
      </button>
      <div class="collapse navbar-collapse" id="navbarNav">
        <ul class="navbar-nav">
          <li class="nav-item">
            <a class="nav-link" href="https://blogs.blackberry.com/en/category/cybersecurity">Cybersecurity</a>
          </li>
          <li class="nav-item">
            <a class="nav-link" href="https://blogs.blackberry.com/en/category/automotive">Automotive & IOT</a>
          </li>
          <li class="nav-item">
            <a class="nav-link" href="https://blogs.blackberry.com/en/category/critical-event-management">Critical Communications</a>
          </li>
          <li class="nav-item">
            <a class="nav-link" href="https://blogs.blackberry.com/en/category/blackberry-news">Inside BlackBerry</a>
          </li>
        </ul>
  
  
        <ul class="navbar-nav ml-auto">
          <li class="nav-item">
            
            <a class="nav-link open-search-btn" role="button">
              <svg aria-hidden="true" data-prefix="fa" data-icon="search" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" data-fa-i2svg="">
                <path fill="currentColor" d="M505 442.7L405.3 343c-4.5-4.5-10.6-7-17-7H372c27.6-35.3 44-79.7 44-128C416 93.1 322.9 0 208 0S0 93.1 0 208s93.1 208 208 208c48.3 0 92.7-16.4 128-44v16.3c0 6.4 2.5 12.5 7 17l99.7 99.7c9.4 9.4 24.6 9.4 33.9 0l28.3-28.3c9.4-9.4 9.4-24.6.1-34zM208 336c-70.7 0-128-57.2-128-128 0-70.7 57.2-128 128-128 70.7 0 128 57.2 128 128 0 70.7-57.2 128-128 128z">
                </path>
              </svg>
            </a>
            <div id="searchOverlay" class="search-overlay">
              <span class="close-search-btn" title="Close Search">×</span>
              <div class="overlay-content">
                <form id="search-form">
                  <input id="search-form--input" description="Search" data-search-url="https://blogs.blackberry.com/en/search" type="text" placeholder="Search" name="search"/>
                  <button type="submit">
                    <svg aria-hidden="true" data-prefix="fa" data-icon="search" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" data-fa-i2svg="">
                      <path fill="currentColor" d="M505 442.7L405.3 343c-4.5-4.5-10.6-7-17-7H372c27.6-35.3 44-79.7 44-128C416 93.1 322.9 0 208 0S0 93.1 0 208s93.1 208 208 208c48.3 0 92.7-16.4 128-44v16.3c0 6.4 2.5 12.5 7 17l99.7 99.7c9.4 9.4 24.6 9.4 33.9 0l28.3-28.3c9.4-9.4 9.4-24.6.1-34zM208 336c-70.7 0-128-57.2-128-128 0-70.7 57.2-128 128-128 70.7 0 128 57.2 128 128 0 70.7-57.2 128-128 128z">
                      </path>
                    </svg>
                  </button>
                </form>
              </div>
            </div>
          </li>
        </ul>
      </div>
    </div>
  </nav>



<!-- END DO NOT INDEX -->



<!-- END DO NOT INDEX -->

    
    
    <div class="hero">

      <div class="jumbotron mastheadDefault">
        <div class="hero-container narrower" style="background-image: url( \2f content\2f dam\2f blackberry-com\2fImages\2fsupport\2f bgs\2f bnr-blue-gradient-crop.jpg)">
          
          <div class="mask  "></div>

          <div class="container headings  l-align">
            <div class="col-lg-12">
          		




    
    
    <div class="blog-name-title">

  <div class="cmp-title ">
  
  
   <!-- <span class="highlighted-text-title blogs">INSIDE</span>
   <span class="normal-text-title">BlackBerry Blog</span> -->
   <span class="normal-text-title">BlackBerry Blog</span>
  
  
  
</div>
</div>



          	</div>
          </div>
      </div>
    </div>
</div>



</header><main>
    




    
    
    <div class="section">
  <section class="section     ">
    
    <div class="container">
        




    
    
    
<ol class="breadcrumb">
    <li class="breadcrumb-item ">
        <a href="/en.html">BlackBerry Blog</a>
    </li>

    <li class="breadcrumb-item active">
        Threat Spotlight: Ratsnif - New Network Vermin from OceanLotus
    </li>
</ol>

    


      
    </div>
  </section>
    

</div>


    
    
    <div class="blogsection">
    <section class="section     ">
      
      <div class="container sectionPadding py-0">
           
      <div class="col-md-9 col-lg-9 col-sm-12">
          




    
    
    <div class="cmp cmp-title blog-title row">
  

<div class="col-md-12 col-lg-12 col-sm-12">
<h1>Threat Spotlight: Ratsnif - New Network Vermin from OceanLotus</h1>
</div>



    
</div>


    
    
    <div class="categorydateauthor"><!--Pulling author bio from author page-->
<div class="categorydateauthor">
<span><a title="RESEARCH &amp; INTELLIGENCE" href="/en/category/research-and-intelligence">RESEARCH &amp; INTELLIGENCE</a> / </span><span class='publish-date'></span>07.01.19 / </span>

    <span class="author"><a href="/en/author/the-cylance-threat-research-team">The BlackBerry Cylance Threat Research Team</a></span>

</div></div>


    
    
    <div class="socialsharing">

<div class='socialSharing row'>
  <ul class='socialSharing-icons'>
    <li>
        <a href='https://twitter.com/intent/tweet?url=https://blogs.blackberry.com/en/2019/07/threat-spotlight-ratsnif-new-network-vermin-from-oceanlotus&text=Threat%20Spotlight:%20Ratsnif%20-%20New%20Network%20Vermin%20from%20OceanLotus&via=BlackBerry' title="Share on Twitter" target="_blank" class="twitter-share">
        <span class='sr-only sr-only-focusable'>Share on Twitter</span>
        <span class='svgIcon-socialSharing svgIcon-socialSharing--tw' aria-hidden='true'>
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path d="M459.37 151.716c.325 4.548.325 9.097.325 13.645 0 138.72-105.583 298.558-298.558 298.558-59.452 0-114.68-17.219-161.137-47.106 8.447.974 16.568 1.299 25.34 1.299 49.055 0 94.213-16.568 130.274-44.832-46.132-.975-84.792-31.188-98.112-72.772 6.498.974 12.995 1.624 19.818 1.624 9.421 0 18.843-1.3 27.614-3.573-48.081-9.747-84.143-51.98-84.143-102.985v-1.299c13.969 7.797 30.214 12.67 47.431 13.319-28.264-18.843-46.781-51.005-46.781-87.391 0-19.492 5.197-37.36 14.294-52.954 51.655 63.675 129.3 105.258 216.365 109.807-1.624-7.797-2.599-15.918-2.599-24.04 0-57.828 46.782-104.934 104.934-104.934 30.213 0 57.502 12.67 76.67 33.137 23.715-4.548 46.456-13.32 66.599-25.34-7.798 24.366-24.366 44.833-46.132 57.827 21.117-2.273 41.584-8.122 60.426-16.243-14.292 20.791-32.161 39.308-52.628 54.253z"/></svg>
        </span>
      </a>
    </li>    
    <li>
      <a href='https://www.facebook.com/sharer/sharer.php?u=https://blogs.blackberry.com/en/2019/07/threat-spotlight-ratsnif-new-network-vermin-from-oceanlotus' title="Share on FaceBook" target="_blank" class="facebook-share">
        <span class='sr-only sr-only-focusable'>Share on Facebook</span>
        <span class='svgIcon-socialSharing svgIcon-socialSharing--fb' aria-hidden='true'>
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 264 512"><path d="M76.7 512V283H0v-91h76.7v-71.7C76.7 42.4 124.3 0 193.8 0c33.3 0 61.9 2.5 70.2 3.6V85h-48.2c-37.8 0-45.1 18-45.1 44.3V192H256l-11.7 91h-73.6v229"/></svg>
        </span>
      </a>
    </li>
    <li>
      <a href="https://www.linkedin.com/shareArticle?mini=true&url=https://blogs.blackberry.com/en/2019/07/threat-spotlight-ratsnif-new-network-vermin-from-oceanlotus&title=Threat%20Spotlight:%20Ratsnif%20-%20New%20Network%20Vermin%20from%20OceanLotus&summary=&source=blogs.blackberry.com" title="Share on LinkedIn" target="_blank" class="linkedin-share">
        <span class='sr-only sr-only-focusable'>Share on Linked In</span>
        <span class='svgIcon-socialSharing svgIcon-socialSharing--li' aria-hidden='true'>
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448.1 512"><path d="M100.3 448H7.4V148.9h92.9V448zM53.8 108.1C24.1 108.1 0 83.5 0 53.8S24.1 0 53.8 0s53.8 24.1 53.8 53.8-24.1 54.3-53.8 54.3zM448 448h-92.7V302.4c0-34.7-.7-79.2-48.3-79.2-48.3 0-55.7 37.7-55.7 76.7V448h-92.8V148.9h89.1v40.8h1.3c12.4-23.5 42.7-48.3 87.9-48.3 94 0 111.3 61.9 111.3 142.3V448h-.1z"/></svg>
        </span>
      </a>
    </li>
    <li>
      <a href="mailto:?subject=Threat%20Spotlight:%20Ratsnif%20-%20New%20Network%20Vermin%20from%20OceanLotus&body=https://blogs.blackberry.com/en/2019/07/threat-spotlight-ratsnif-new-network-vermin-from-oceanlotus" title="Email" class="email-share">
        <span class='sr-only sr-only-focusable'>Email</span>
        <span class='svgIcon-socialSharing svgIcon-socialSharing--li' aria-hidden='true'>
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path d="M502.3 190.8c3.9-3.1 9.7-.2 9.7 4.7V400c0 26.5-21.5 48-48 48H48c-26.5 0-48-21.5-48-48V195.6c0-5 5.7-7.8 9.7-4.7 22.4 17.4 52.1 39.5 154.1 113.6 21.1 15.4 56.7 47.8 92.2 47.6 35.7.3 72-32.8 92.3-47.6 102-74.1 131.6-96.3 154-113.7zM256 320c23.2.4 56.6-29.2 73.4-41.4 132.7-96.3 142.8-104.7 173.4-128.7 5.8-4.5 9.2-11.5 9.2-18.9v-19c0-26.5-21.5-48-48-48H48C21.5 64 0 85.5 0 112v19c0 7.4 3.4 14.3 9.2 18.9 30.6 23.9 40.7 32.4 173.4 128.7 16.8 12.2 50.2 41.8 73.4 41.4z"/></svg>
        </span>
      </a>
    </li>    
  </ul>
</div>
</div>


    
    
    <div class="image">
  <div data-cmp-is="image" data-cmp-src="/en/2019/07/threat-spotlight-ratsnif-new-network-vermin-from-oceanlotus/_jcr_content/main/par/sectionblog/par/image.coreimg{.width}.jpeg/1596073918426/190619-oceanlotus-ratsnif-1-lrg.jpeg" data-asset="/content/dam/blogs-blackberry-com/images/blogs/2019/07/190619-oceanlotus-ratsnif-1-lrg.jpg" data-asset-id="7a2cecc8-6a42-430b-b437-60456dfd0527" class="cmp-image" itemscope itemtype="http://schema.org/ImageObject">
 
     
         
         
          
         <img src="/content/dam/blogs-blackberry-com/images/blogs/2019/07/190619-oceanlotus-ratsnif-1-lrg.jpg" class="cmp-image__image" itemprop="contentUrl" data-cmp-hook-image="image" alt/>
         
         <figcaption class="figure-caption" styles="display:table-caption;caption-side:bottom;"></figcaption>
          
     
 
 
 
</div>

    
</div>


    
    
    <div class="text">    
    
    <div class='cylance-blog-container'><h2>Overview</h2> <p>The OceanLotus Group (aka APT32, CobaltKitty | previous reports: <a href="https://threatvector.cylance.com/en_us/home/report-the-spyrats-of-oceanlotus.html" target="_blank">The SpyRATs of OceanLotus</a>; <a href="https://threatvector.cylance.com/en_us/home/report-oceanlotus-apt-group-leveraging-steganography.html" target="_blank">OceanLotus APT Group Leveraging Steganography</a>) is using a suite of remote access trojans dubbed &quot;Ratsnif&quot; to leverage new network attack capabilities. Blackberry Cylance threat researchers have analyzed the Ratsnif trojans, which offer a veritable swiss-army knife of network attack techniques.&nbsp;The trojans, under active development since 2016, combine capabilities like packet sniffing, gateway/device ARP poisoning, DNS poisoning, HTTP injection, and MAC spoofing.&nbsp;<br> <br> We delved into four distinct Ratsnif samples, three of them developed in 2016, the fourth created during the latter half of 2018.</p> <h2>Sample 1</h2> <table border="1" cellspacing="0" cellpadding="0"> <tbody><tr><td width="133" valign="top"><p style="text-align: right;"><b>&nbsp; MD5&nbsp;&nbsp;</b></p> </td> <td width="475" valign="top"><p>&nbsp; 516ad28f8fa161f086be7ca122351edf</p> </td> </tr><tr><td width="133" valign="top"><p style="text-align: right;"><b>&nbsp; SHA256&nbsp;&nbsp;</b></p> </td> <td width="475" valign="top"><p>b4e3b2a1f1e343d14af8d812d4a29440940b99aaf145b5699dfe277b5bfb8405</p> </td> </tr><tr><td width="133" valign="top"><p style="text-align: right;"><b>&nbsp; Filename&nbsp;&nbsp;</b></p> </td> <td width="475" valign="top"><p>&nbsp; javaw.exe, Client.exe</p> </td> </tr><tr><td width="133" valign="top"><p style="text-align: right;"><b>&nbsp; Path&nbsp;&nbsp;</b></p> </td> <td width="475" valign="top"><p>&nbsp; X:\Project\BotFrame\Debug\Client.exe</p> </td> </tr><tr><td width="133" valign="top"><p style="text-align: right;"><b>&nbsp; Size&nbsp;&nbsp;</b></p> </td> <td width="475" valign="top"><p>&nbsp; 1.32 MB (1,387,520 bytes)</p> </td> </tr><tr><td width="133" valign="top"><p style="text-align: right;"><b>&nbsp; File Type&nbsp;&nbsp;</b></p> </td> <td width="475" valign="top"><p>&nbsp; PE32 executable for MS Windows (console) Intel 80386 32-bit</p> </td> </tr><tr><td width="133" valign="top"><p style="text-align: right;"><b>&nbsp; Alias&nbsp;&nbsp;</b></p> </td> <td width="475" valign="top"><p>&nbsp; OceanLotus APT32 Ratsnif</p> </td> </tr><tr><td width="133" valign="top"><p style="text-align: right;"><b>&nbsp; Compile&nbsp; &nbsp;<br>  Time&nbsp; &nbsp;</b></p> </td> <td width="475" valign="top"><p>&nbsp; 2016-08-05 07:57:13</p> </td> </tr></tbody></table> <h3><i><br> Overview</i></h3> <p>The earliest example of Ratsnif uncovered thus far was compiled on the same day that its C2 domain was first activated:</p> <p style="text-align: center;"><img src="/content/dam/blogs-blackberry-com/images/blogs/2019/07/Fig0-ratsnif.png"></p> <p>It appears to be a debug build, and closely resembles a later variant from September 2016 that will be the main focus of analysis for the three 2016 variants described in this article.&nbsp;</p> <h2>Sample 2</h2> <table border="1" cellspacing="0" cellpadding="0"> <tbody><tr><td width="133" valign="top"><p style="text-align: right;"><b>MD5&nbsp;&nbsp;</b></p> </td> <td width="462" valign="top"><p style="text-align: left;">&nbsp; b2f8c9ce955d4155d466fbbb7836e08b</p> </td> </tr><tr><td width="133" valign="top"><p style="text-align: right;"><b>SHA256&nbsp;&nbsp;</b></p> </td> <td width="476" valign="top"><p style="text-align: left;">&nbsp; b214c7a127cb669a523791806353da5c5c04832f123a0a6df118642eee1632a3</p> </td> </tr><tr><td width="133" valign="top"><p style="text-align: right;"><b>Filename&nbsp;&nbsp;</b></p> </td> <td width="462" valign="top"><p style="text-align: left;">&nbsp; javaw.exe, Client.exe</p> </td> </tr><tr><td width="133" valign="top"><p style="text-align: right;"><b>Path&nbsp;&nbsp;</b></p> </td> <td width="462" valign="top"><p style="text-align: left;">&nbsp; X:\Project\BotFrame\Debug\Client.exe</p> </td> </tr><tr><td width="133" valign="top"><p style="text-align: right;"><b>Size&nbsp;&nbsp;</b></p> </td> <td width="462" valign="top"><p style="text-align: left;">&nbsp; 1.32 MB (1,387,520 bytes)</p> </td> </tr><tr><td width="133" valign="top"><p style="text-align: right;"><b>File type&nbsp;&nbsp;</b></p> </td> <td width="462" valign="top"><p style="text-align: left;">&nbsp; PE32 executable for MS Windows (console) Intel 80386 32-bit</p> </td> </tr><tr><td width="133" valign="top"><p style="text-align: right;"><b>Alias&nbsp;&nbsp;</b></p> </td> <td width="462" valign="top"><p style="text-align: left;">&nbsp; OceanLotus APT32 Ratsnif</p> </td> </tr><tr><td width="133" valign="top"><p style="text-align: right;"><b>Compile&nbsp;&nbsp;<br>  Time&nbsp;&nbsp;</b></p> </td> <td width="462" valign="top"><p style="text-align: left;">&nbsp;2016-08-06 04:30:06</p> </td> </tr></tbody></table> <h3><i><br> Overview</i></h3> <p>Compiled less than 24 hours after the previous sample, this build contains only one minor difference in functionality, whereby a call to <i>pcap_dump_flush() </i>has been removed prior to recompilation:<br> </p> <p style="text-align: left;"><img src="/content/dam/blogs-blackberry-com/images/blogs/2019/07/Fig1-ratsnif.PNG"><br> <i>Figure 1. Call to pcap_dump_flush in b4e3b2a1f1e343d14af8d812d4a29440940b99aaf145b5699dfe277b5bfb8405&nbsp;</i></p> <p style="text-align: left;"><img src="/content/dam/blogs-blackberry-com/images/blogs/2019/07/Fig2-ratsnif.PNG"><br> <i>Figure 2. Missing call to pcap_dump_flush in b214c7a127cb669a523791806353da5c5c04832f123a0a6df118642eee1632a3</i></p> <p>In addition, the CodeView debugging information has changed, reflecting the new &quot;age&quot; of the sample after recompilation:<br> </p> <p style="text-align: left;"><img src="/content/dam/blogs-blackberry-com/images/blogs/2019/07/Fig3-ratsnif.PNG"><br> <i>Figure 3. Age of 0x14 in b4e3b2a1f1e343d14af8d812d4a29440940b99aaf145b5699dfe277b5bfb8405</i></p> <p style="text-align: left;"><img src="/content/dam/blogs-blackberry-com/images/blogs/2019/07/Fig4-ratsnif.PNG"><br> <i>Figure 4. Age of 0x15 in b214c7a127cb669a523791806353da5c5c04832f123a0a6df118642eee1632a3</i></p> <p>Both samples were submitted to VirusTotal within a minute of being compiled and contain the same path as the PDB information. It seems likely this sample was automatically submitted to an online scanning service by the developer:<br> </p> <p style="text-align: left;"><img src="/content/dam/blogs-blackberry-com/images/blogs/2019/07/Fig5-ratsnif.png"><i><br> Figure 5. VirusTotal submission showing date/time and path</i></p> <h2>Sample 3</h2> <table border="1" cellspacing="0" cellpadding="0"> <tbody><tr><td width="133" valign="top"><p style="text-align: right;"><b>MD5&nbsp;&nbsp;</b></p> </td> <td width="473" valign="top"><p>&nbsp; 7f0ac1b4e169edc62856731953dad126</p> </td> </tr><tr><td width="133" valign="top"><p style="text-align: right;"><b>SHA256&nbsp;&nbsp;</b></p> </td> <td width="473" valign="top"><p>&nbsp; b20327c03703ebad191c0ba025a3f26494ff12c5908749e33e71589ae1e1f6b3</p> </td> </tr><tr><td width="133" valign="top"><p style="text-align: right;"><b>Filename&nbsp;&nbsp;</b></p> </td> <td width="473" valign="top"><p>&nbsp; javaw.exe, adobe.exe</p> </td> </tr><tr><td width="133" valign="top"><p style="text-align: right;"><b>Path&nbsp;&nbsp;</b></p> </td> <td width="473" valign="top"><p>&nbsp; N/A</p> </td> </tr><tr><td width="133" valign="top"><p style="text-align: right;"><b>Size&nbsp;&nbsp;</b></p> </td> <td width="473" valign="top"><p>&nbsp; 432 KB (442,880 bytes)</p> </td> </tr><tr><td width="133" valign="top"><p style="text-align: right;"><b>File Type&nbsp;&nbsp;</b></p> </td> <td width="473" valign="top"><p>&nbsp; PE32 executable (DLL) (GUI) Intel 80386, for MS Windows</p> </td> </tr><tr><td width="133" valign="top"><p style="text-align: right;"><b>Alias&nbsp;&nbsp;</b></p> </td> <td width="473" valign="top"><p>&nbsp; OceanLotus APT32 Ratsnif</p> </td> </tr><tr><td width="133" valign="top"><p style="text-align: right;"><b>Compile&nbsp;&nbsp;<br>  Time&nbsp;&nbsp;</b></p> </td> <td width="473" valign="top"><p>&nbsp; 2016-09-13 09:26:42</p> </td> </tr></tbody></table> <h3><i><br> Overview</i></h3> <p>Remarkably similar in functionality to the previous samples from August 2016, this sample is a release build and was likely one of the earlier Ratsnifs to be deployed by OceanLotus in-the-wild.</p> <h3><i>Threat Features</i></h3> <ul> <li>C2 over HTTP</li> <li>Packet sniffing</li> <li>ARP poisoning</li> <li>DNS spoofing</li> <li>HTTP redirection</li> <li>Remote shell</li> </ul> <h3><i>Analysis</i></h3> <p>Upon execution, Ratsnif creates a run once mutex named &quot;onceinstance&quot;, initialises Winsock version 2.2, and harvests system information such as the username, computer name, workstation configuration (via NetWkstaGetInfo API), Windows system directory and network adapter information. This information will then be sent to the attacker's C2 server via an HTTP post to the /<i>cl_client_online.php </i>API endpoint. Next, a logging thread is created, which is used to route log messages to the C2 via HTTP POST requests to <i>/cl_client_logs.php.</i> The malware then proceeds to load wpcap.dll, before importing the following functions:</p> <ul> <li>pcap_sendqueue_transmit</li> <li>pcap_findalldevs</li> <li>pcap_freealldevs</li> <li>pcap_open_live</li> <li>pcap_sendqueue_alloc</li> <li>pcap_next_ex</li> <li>pcap_sendqueue_queue</li> <li>pcap_sendpacket</li> <li>pcap_close</li> <li>pcap_sendqueue_destroy</li> <li>pcap_dump_open</li> <li>pcap_dump_ftell</li> <li>pcap_dump_flush</li> <li>pcap_dump_close</li> <li>pcap_dump</li> </ul> <p>With WinPcap successfully loaded, a further HTTP POST request is made to <i>/cl_client_cmd.php, </i>which is used to obtain a command code from the attacker. This code will check for commands every 10 seconds. C2 commands are decrypted using AES with a hard-coded static key via Windows APIs, before being dispatched by a simple command processor.</p> <h3><i>C2</i></h3> <p>All observed Ratsnif samples have been hardcoded with one or more C2 domains, regardless of whether they are used. This sample contains 2 hard-coded domains, although only one appears to have ever been active:</p> <ul> <li>search[.]webstie[.]net</li> <li>dns[.]domain-resolve[.]org (inactive)</li> </ul> <p>The C2 server itself is expected to expose a fairly intuitively named web API, supporting the following endpoints:</p> <table border="1" cellspacing="0" cellpadding="0"> <tbody><tr><td width="160" valign="top"><p style="text-align: left;"><b>&nbsp; URL&nbsp;</b></p> </td> <td width="295" valign="top"><p style="text-align: left;"><b>&nbsp; Description</b></p> </td> </tr><tr><td width="160" valign="top"><p style="text-align: left;">&nbsp; /cl_client_online.php&nbsp;&nbsp;</p> </td> <td width="301" valign="top"><p>&nbsp; POST containing harvested system information</p> </td> </tr><tr><td width="160" valign="top"><p style="text-align: left;">&nbsp; /cl_client_cmd.php&nbsp;&nbsp;</p> </td> <td width="295" valign="top"><p>&nbsp; GET C2 command</p> </td> </tr><tr><td width="162" valign="top"><p style="text-align: left;">&nbsp; /cl_client_cmd_res<br> .php&nbsp;&nbsp;</p> </td> <td width="293" valign="top"><p>&nbsp; POST result of C2 command</p> </td> </tr><tr><td width="160" valign="top"><p style="text-align: left;">&nbsp; /cl_client_logs.php&nbsp;&nbsp;</p> </td> <td width="295" valign="top"><p>&nbsp; POST log message</p> </td> </tr></tbody></table> <p><br> The malware contains support for the following commands issued via the <i>cl_client_cmd.php </i>HTTP response:</p> <p style="text-align: center;"><img src="/content/dam/blogs-blackberry-com/images/blogs/2019/07/table1-ratsnif.png"></p> <h2>Sample 4</h2> <table border="1" cellspacing="0" cellpadding="0"> <tbody><tr><td width="133" valign="top"><p style="text-align: right;"><b>MD5&nbsp;&nbsp;</b></p> </td> <td width="474" valign="top"><p>&nbsp; 88eae0d31a6c38cfb615dd75918b47b1</p> </td> </tr><tr><td width="133" valign="top"><p style="text-align: right;"><b>SHA256&nbsp;&nbsp;</b></p> </td> <td width="474" valign="top"><p>&nbsp; 7fd526e1a190c10c060bac21de17d2c90eb2985633c9ab74020a2b78acd8a4c8</p> </td> </tr><tr><td width="133" valign="top"><p style="text-align: right;"><b>Filename&nbsp;&nbsp;</b></p> </td> <td width="474" valign="top"><p>&nbsp; N/A</p> </td> </tr><tr><td width="133" valign="top"><p style="text-align: right;"><b>Path&nbsp;&nbsp;</b></p> </td> <td width="474" valign="top"><p>&nbsp; N/A</p> </td> </tr><tr><td width="133" valign="top"><p style="text-align: right;"><b>Size&nbsp;&nbsp;</b></p> </td> <td width="474" valign="top"><p>&nbsp; 745 KB (762,880 bytes)</p> </td> </tr><tr><td width="133" valign="top"><p style="text-align: right;"><b>File Type&nbsp;&nbsp;</b></p> </td> <td width="474" valign="top"><p>&nbsp; PE32 executable (DLL) (GUI) Intel 80386, for MS Windows</p> </td> </tr><tr><td width="133" valign="top"><p style="text-align: right;"><b>Alias&nbsp;&nbsp;</b></p> </td> <td width="474" valign="top"><p>&nbsp; OceanLotus APT32 Ratsnif</p> </td> </tr><tr><td width="133" valign="top"><p style="text-align: right;"><b>Compile&nbsp;&nbsp;<br>  Time&nbsp;&nbsp;</b></p> </td> <td width="474" valign="top"><p>&nbsp; Wed, 08 Aug 2018 02:52:52 UTC</p> </td> </tr></tbody></table> <h3><i><br> Overview</i></h3> <p>Surfacing during the latter half of 2018 and wrapped in a bespoke OceanLotus shellcode loader, this sample was first reported in a blog from <a href="http://blog.macnica.net/blog/2019/04/oceanlotus-218a.html">Macnica Networks</a>. Compared to the 2016 variants this sample introduces a configuration file and does not rely on C2 for operation. It also adds new features in the form of HTTP injection, protocol parsing, and SSL hijacking.</p> <h3><i>Threat Features</i></h3> <ul> <li>Deployed by OceanLotus loader</li> <li>Use of separately supplied configuration file, tailored to the victim’s network environment (as opposed to backdoor commands in the previous versions)</li> <li>Use of separately supplied SSL certificates to perform SSL hijacking</li> <li>Use of WolfSSL library (version 3.11) for decryption of SSL traffic (<a href="https://github.com/wolfSSL/wolfssl" target="_blank">https://github.com/wolfSSL/wolfssl</a>)</li> <li>Use of http_parser.c for parsing HTTP traffic (<a href="https://elixir.bootlin.com/zephyr/v1.13.0/source/subsys/net/lib/http/http_parser.c" target="_blank">https://elixir.bootlin.com/zephyr/v1.13.0/source/subsys/net/lib/http/http_parser.c</a>)</li> <li>Packet sniffing focused on extracting login credentials and other sensitive data via protocol parsing</li> <li>ARP poisoning</li> <li>DNS spoofing</li> <li>HTTP redirection</li> <li>HTTP injection</li> </ul> <h3><i>Analysis</i></h3> <p>For this particular sample, the actual sniffer executable is Base64 encoded within a loader DLL and wrapped in two layers of shellcode. The loader DLL decodes the payload, copies it to memory and executes the 1<sup>st</sup> stage shellcode, which will decompress the binary and execute the 2<sup>nd</sup> stage shellcode in a separate thread. The 2<sup>nd</sup> stage shellcode will inject the sniffer executable into memory and hook several API functions responsible for returning the process command line (GetCommandLineA, GetCommandLineW, _acmdln, _wcmdln), so they return a hardcoded string instead. The string contains the parameter that specifies a path to the config file, as well as the executable’s original path:</p> <table border="1" cellspacing="0" cellpadding="0"> <tbody><tr><td width="719" valign="top"><p>&nbsp; C:\Users\Administrator\Desktop\api\temp\royal\HkYh9CvH7.exe -p<br> &nbsp; C:\ProgramData\setting.cfg</p> </td> </tr></tbody></table> <p><i>Figure 6. Embedded command-line</i></p> <p>It is not immediately obvious why the attackers used this convoluted method to pass the config path to the malware.</p> <p>The configuration file is a simple text file, Base64 encoded, where the first line is ignored, and each subsequent line specifies a parameter. For example:</p> <table border="1" cellspacing="0" cellpadding="0"> <tbody><tr><td width="719" valign="top">&nbsp; [unused_line]<br> &nbsp; -ip [ATTACKER IP ADDRESS]<br> &nbsp; -ga [DEFAULT GATEWAY]<br> &nbsp; -subnet [SUBNET MASK]<br> &nbsp; -sniff -ssl_ip [IP ADDRESS]<br> &nbsp; -html_inject [BROWSER PROCESS NAME]<br> &nbsp; -dlog_ip [IP ADDRESS]<br> &nbsp; -mac [ATTACKER MAC ADDRESS] &quot;true&quot;|&quot;false&quot;<br> &nbsp; -name [DOMAIN NAME] [REDIRECTION IP]<br> &nbsp; -all<br> &nbsp; -dnsttl [INT VALUE]<br> &nbsp; -log [LOGFILE PATH]<br> &nbsp; -pass [CREDENTIALS DUMP PATH]<br> &nbsp; -dwn_ip [IP ADDRESS]</td> </tr></tbody></table> <p><i>Figure 7. Configuration file options</i></p> <p>However, there is a bug in parsing the value of the <i>dwn_ip</i> parameter, which will result in a memory read violation if the value is present in the configuration:<br> </p> <p style="text-align: left;"><img src="/content/dam/blogs-blackberry-com/images/blogs/2019/07/Fig8-ratsnif.PNG"><br> <i>Figure 8: Bug in the code: the value of &quot;dwn_ip&quot; is passed as a string, while print_debug_msg expects a pointer to a string</i></p> <p>Once executed, the sniffer will read the configuration from the specified file, decode it using Base64 and parse it to an in-memory structure. If the &quot;-sniff&quot; parameter is specified in the configuration, the malware will add a firewall exception and disable Large Send Offload (LSO) for each network adapter in the registry:</p> <table border="1" cellspacing="0" cellpadding="0"> <tbody><tr><td width="719" valign="top"><p>&nbsp; netsh advfirewall firewall add rule name=\&quot;Core Networking - Router Solicitation\&quot; dir=in action=allow program={self_path} enable=yes</p> </td> </tr></tbody></table> <p><i>Figure 9. Command-line used to add Windows firewall rule</i></p> <table border="1" cellspacing="0" cellpadding="0"> <tbody><tr><td width="719" valign="top"><p>&nbsp; wmic path win32_networkadapter where index=%d call disable</p> </td> </tr></tbody></table> <p><i>Figure 10. Command-line used to disable network adapters prior to disabling LSOs</i></p> <p>After importing the same APIs from wpcap.dll as the 2016 variants (with the addition of pcap_geterr), the malware creates threads responsible for ARP poisoning and DNS spoofing.</p> <p>In order to be able to decrypt the SSL traffic, the malware performs SSL hijacking, using an open source library called WolfSSL and separately supplied certificate and private key files. For that purpose, it creates an internal WolfSSL server, listening on the first available port in the range 65000 – 65535:</p> <p style="text-align: left;"><img src="/content/dam/blogs-blackberry-com/images/blogs/2019/07/Fig11-ratsnif.PNG"><br> <i>Figure 11: Use of WolfSSL</i><br> </p> <p>Unlike the 2016 variants of Ratsnif that stored all packets to a PCAP file, the 2018 variant employs multiple sniffer classes for harvesting sensitive information from packets. This will minimize the amount of data the attacker has to collect, exfiltrate and process, and also reveals what information the attacker is interested in.<br> </p> <p>The malware can sniff traffic for the following protocols/ports:</p> <table border="1" cellspacing="0" cellpadding="0"> <tbody><tr><td width="94" valign="top"><p><b>&nbsp; Interface</b></p> </td> <td width="162" valign="top"><p><b>&nbsp; Ports</b></p> </td> <td width="462" valign="top"><p><b>&nbsp; Headers</b></p> </td> </tr><tr><td width="94" valign="top"><p>&nbsp; CSniffFtp</p> </td> <td width="162" valign="top"><p>&nbsp; 21, 990</p> </td> <td width="462"><p>&nbsp; ABOR ACCT ADAT ALLO APPE AUTH CCC CDUP CONF CWD DELE ENC EPRT EPSV FEAT HELP HOST LANG LIST LPRT LPSV MDTM MIC MKD MLSD MLST MODE NLST OPTS PASS PASV PBSZ PORT PROT PWD QUIT REIN REST RETR RMD RNFR RNTO SITE SIZE SMNT STAT STOR STOU STRU SYST TYPE USER XCUP XMKD XPWD XRCP XRMD XRSQ XSEM XSEN 230</p> </td> </tr><tr><td width="94" valign="top"><p>&nbsp; CSniffImap</p> </td> <td width="162" valign="top"><p>&nbsp; 143, 993</p> </td> <td width="462"><p>&nbsp; CAPABILITY LOGOUT STARTTLS AUTHENTICATE LOGIN SELECT EXAMINE CREATE RENAME LSUB STATUS APPEND CHECK CLOSE EXPUNGE FETCH STORE UID</p> </td> </tr><tr><td width="94" valign="top"><p>&nbsp; CSniffLdap</p> </td> <td width="162" valign="top"><p>&nbsp; 389, 636, 10389, 10636</p> </td> <td width="462"><p>&nbsp; Various</p> </td> </tr><tr><td width="94" valign="top"><p>&nbsp; CSniffNntp</p> </td> <td width="162" valign="top"><p>&nbsp; 119</p> </td> <td width="462"><p>&nbsp; AUTHINFO USER AUTHINFO PASS ANONYMOUS 281</p> </td> </tr><tr><td width="94" valign="top"><p>&nbsp; CSniffPop</p> </td> <td width="162" valign="top"><p>&nbsp; 110, 995</p> </td> <td width="462"><p>&nbsp; RCEV RCVD RSET +OK USER PASS RETR QUIT</p> </td> </tr><tr><td width="94" valign="top"><p>&nbsp; CSniffSmb</p> </td> <td width="162" valign="top"><p>&nbsp; 445</p> </td> <td width="462"><p>&nbsp; Various</p> </td> </tr><tr><td width="94" valign="top"><p>&nbsp; CSniffSmtp</p> </td> <td width="162" valign="top"><p>&nbsp; 25, 465</p> </td> <td width="462"><p>&nbsp; HELO MAIL RCPT SEND SOML SAML VRFY EXPN TURN FROM</p> </td> </tr><tr><td width="94" valign="top"><p>&nbsp; CSniffTds</p> </td> <td width="162" valign="top"><p>&nbsp; 1433</p> </td> <td width="462"><p>&nbsp; SELECT name, password_hash FROM master.sys.sql_logins where is_disabled = 0; -- priv</p> </td> </tr><tr><td width="94" valign="top"><p>&nbsp; CSniffTelnet</p> </td> <td width="162" valign="top"><p>&nbsp; 23</p> </td> <td width="462"><p>&nbsp; Login Failed login: password:</p> </td> </tr><tr><td width="94" valign="top"><p>&nbsp; SniffHttp2</p> </td> <td width="162" valign="top"><p>&nbsp; 80, 443</p> </td> <td width="462"><p>&nbsp; Various</p> </td> </tr></tbody></table> <p><br> Each sniffer class interface contains two methods for extracting sensitive information from the incoming and outgoing packets, respectively. These typically rely on searching for cleartext header strings to facilitate credential theft:<br> </p> <p style="text-align: left;"><i><img src="/content/dam/blogs-blackberry-com/images/blogs/2019/07/Fig12-ratsnif.PNG"><br> Figure 12. Searching for login and password commands in the Telnet protocol<br>  </i><br> In addition, the HTTP sniffer interface is also able to perform injection to insert arbitrary attacker supplied content into HTML.<i><br> </i></p> <h3><i>C2</i></h3> <p>Although this sample contains a Base64 encoded C2 URL hardcoded in the .rdata section (the same address as in the 2016 versions), the malware never seems to use it; instead, it logs the captured information into text files for further exfiltration by another module.</p> <h3><i>Example</i></h3> <p>To recreate conditions in which the sample would operate, a default gateway was configured on 192.168.8.135 and was running iNetSim to act as the DNS and HTTP servers. The attacker machine was located at 192.168.8.134 and the victim at 192.168.8.138. Ratsnif was configured to operate as follows:</p> <table border="1" cellspacing="0" cellpadding="0"> <tbody><tr><td width="408" valign="top">&nbsp; TEST CONFIG<br> &nbsp; -ip &quot;<b>192.168.8.134</b>&quot;<br> &nbsp; -ga &quot;<b>192.168.8.135</b>&quot;<br> &nbsp; -subnet &quot;255.255.255.0&quot;<br> &nbsp; -sniff<br> &nbsp; -ssl_ip &quot;192.168.8.254&quot;<br> &nbsp; -html_inject &quot;iexplore.exe&quot;<br> &nbsp; -dlog_ip &quot;192.168.8.254&quot;<br> &nbsp; -mac &quot;<b>00:0C:29:59:62:46</b>&quot; &quot;true&quot;<br> &nbsp; -name &quot;www.google.com&quot; &quot;<b>192.168.8.135</b>&quot;<br> &nbsp; -dnsttl &quot;100&quot;<br> &nbsp; -log &quot;C:\ratsnif.log&quot;<br> &nbsp; -pass &quot;C:\ratsnif.pcap&quot;<br> &nbsp; -dwn_ip</td> </tr></tbody></table> <p><i>Figure 13. Configuration used for testing</i></p> <p>Figure 14 shows the malware sending ARP packets asking for the MAC addresses of all the machines on the subnet specified in the config file, whilst ignoring itself (192.168.8.134) and the default gateway (192.168.8.135):</p> <p style="text-align: left;"><img src="/content/dam/blogs-blackberry-com/images/blogs/2019/07/Fig14-ratsnif.png"><i><br> Figure 14. ARP Broadcasts</i></p> <p>Figure 15 shows the malware sending ARP packets asking for the MAC addresses of all the machines on the subnet specified in the config file, whilst ignoring itself (192.168.8.134) and the default gateway (192.168.8.135): ARP Broadcasts</p> <p>Once it has MAC addresses for all machines on the subnet, Ratsnif will then send unsolicited ARP packets to those addresses, updating the MAC address of the default gateway for each victim:</p> <p style="text-align: left;"><img src="/content/dam/blogs-blackberry-com/images/blogs/2019/07/Fig15-ratsnif.png"><i><br> Figure 15. ARP Poisoning</i></p> <p>Figure 16 shows the effect on the victim machine, with the attacker IP address and the default gateway IP address (192.168.8.135) both now sharing the same physical address:</p> <p style="text-align: left;"><img src="/content/dam/blogs-blackberry-com/images/blogs/2019/07/Fig16-ratsnif.png"><i><br> Figure 16. arp -a results showing poisoned ARP Table on the victim machine</i></p> <p>Once the ARP table is poisoned, all traffic destined for the default gateway will be routed through Ratsnif and can be stored and manipulated prior to retransmission.</p> <p>Finally, Figure 17 shows a poisoned DNS response for <a href="http://www.google.com/" target="_blank">www.google.com</a>, whereby the DNS query was intercepted by Ratsnif, modified to point to an attacker controlled IP address and the fake response sent to the original requestor:</p> <p style="text-align: left;"><i><img src="/content/dam/blogs-blackberry-com/images/blogs/2019/07/Fig17-ratsnif.png"><br> Figure 17. Ratsnif log file output showing ARP poisoning and DNS spoofing in action<br>  <br>  </i><b><i>C2</i></b><i><br> </i></p> <h3><i>search.webstie.net</i></h3> <p><i><b>Whois</b></i></p> <table border="1" cellspacing="0" cellpadding="0" width="391"> <tbody><tr><td width="83"><p style="text-align: right;"><b>Attribute&nbsp;&nbsp;</b></p> </td> <td width="308" valign="bottom"><p><b>&nbsp; Value</b></p> </td> </tr><tr><td width="83"><p style="text-align: right;"><b>Server&nbsp;&nbsp;</b></p> </td> <td width="308"><p>&nbsp; whois.web4africa.net</p> </td> </tr><tr><td width="83"><p style="text-align: right;"><b>Registrar&nbsp;&nbsp;</b></p> </td> <td width="308"><p>&nbsp; WEB4AFRICA INC</p> </td> </tr><tr><td width="83"><p style="text-align: right;"><b>Email&nbsp;&nbsp;</b></p> </td> <td width="308"><p>&nbsp; contact@privacyprotect.org</p> </td> </tr><tr><td width="83"><p style="text-align: right;"><b>Name&nbsp;&nbsp;</b></p> </td> <td width="308"><p>&nbsp; Domain Admin, C/O ID#10760</p> </td> </tr><tr><td width="83"><p style="text-align: right;"><b>Organization&nbsp;&nbsp;</b></p> </td> <td width="308"><p>&nbsp; Privacy Protection Service INC d/b/a PrivacyProtect.org</p> </td> </tr><tr><td width="83"><p style="text-align: right;"><b>Street&nbsp;&nbsp;</b></p> </td> <td width="308"><p>&nbsp; PO Box 16</p> </td> </tr><tr><td width="83"><p style="text-align: right;"><b>City&nbsp;&nbsp;</b></p> </td> <td width="308"><p>&nbsp; Nobby Beach</p> </td> </tr><tr><td width="83"><p style="text-align: right;"><b>State&nbsp;&nbsp;</b></p> </td> <td width="308"><p>&nbsp; Queensland</p> </td> </tr><tr><td width="83"><p style="text-align: right;"><b>Postal&nbsp;&nbsp;</b></p> </td> <td width="308"><p>&nbsp; QLD 4218</p> </td> </tr><tr><td width="83"><p style="text-align: right;"><b>Country&nbsp;&nbsp;</b></p> </td> <td width="308"><p>&nbsp; AUSTRALIA</p> </td> </tr><tr><td width="83"><p style="text-align: right;"><b>Phone&nbsp;&nbsp;</b></p> </td> <td width="308"><p>&nbsp; 4536946676</p> </td> </tr><tr><td width="83"><p style="text-align: right;"><b>NameServers&nbsp;&nbsp;</b></p> </td> <td width="308"><p>&nbsp; ns21.cloudns.net</p> <p>&nbsp; ns22.cloudns.net</p> <p>&nbsp; ns23.cloudns.net</p> <p>&nbsp; ns24.cloudns.net</p> </td> </tr></tbody></table> <p><i><b><br> History</b><br>  <br>  </i>Obtained via Shodan, this history shows when the C2 server exposed various ports, including HTTP, SMB and RDP, for the purpose of controlling Ratsnif and other OceanLotus malware:<i><br> </i></p> <p style="text-align: left;"><i><img src="/content/dam/blogs-blackberry-com/images/blogs/2019/07/Fig18-ratsnif.png"><br> Figure 18. Shodan history for search.webstie.net</i></p> <h2>Conclusions</h2> <p>Ratsnif is an intriguing discovery considering the length of time it has remained undetected, likely due to limited deployment. It offers a rare glimpse of over two years of feature development, allowing us to observe how threat actors tailor tooling to their nefarious purposes. While all samples borrow heavily from open-source code/snippets, overall development quality is deemed to be poor. Simply put, Ratsnif does not meet the usual high standards observed in OceanLotus malware.</p> <h2>Appendix</h2> <h2>Indicators of Compromise (IOCs)</h2> <table border="1" cellspacing="0" cellpadding="0"> <tbody><tr><td width="240" valign="top"><p><b>&nbsp; Indicator</b></p> </td> <td width="240" valign="top"><p><b>&nbsp; Type</b></p> </td> <td width="240" valign="top"><p><b>&nbsp; Description</b></p> </td> </tr><tr><td width="240" valign="top"><p>&nbsp;b4e3b2a1f1e343d14af8d812d4a29440940b99aaf145b5699dfe277b5bfb8405</p> </td> <td width="240" valign="top"><p>&nbsp; SHA256</p> </td> <td width="240" valign="top"><p>&nbsp; Ratsnif</p> </td> </tr><tr><td width="240" valign="top"><p>b214c7a127cb669a523791806353da5c5c04832f123a0a6df118642eee1632a3</p> </td> <td width="240" valign="top"><p>&nbsp; SHA256</p> </td> <td width="240" valign="top"><p>&nbsp; Ratsnif</p> </td> </tr><tr><td width="240" valign="top"><p>b20327c03703ebad191c0ba025a3f26494ff12c5908749e33e71589ae1e1f6b3</p> </td> <td width="240" valign="top"><p>&nbsp; SHA256</p> </td> <td width="240" valign="top"><p>&nbsp; Ratsnif</p> </td> </tr><tr><td width="240" valign="top"><p>7fd526e1a190c10c060bac21de17d2c90eb2985633c9ab74020a2b78acd8a4c8</p> </td> <td width="240" valign="top"><p>&nbsp; SHA256</p> </td> <td width="240" valign="top"><p>&nbsp; Ratsnif</p> </td> </tr><tr><td width="240" valign="top"><p>&nbsp; onceinstance</p> </td> <td width="240" valign="top"><p>&nbsp; Mutex</p> </td> <td width="240" valign="top"><p>&nbsp; Mutex name</p> </td> </tr><tr><td width="240" valign="top"><p>&nbsp; search[.]webstie[.]net</p> </td> <td width="240" valign="top"><p>&nbsp; Domain</p> </td> <td width="240" valign="top"><p>&nbsp; C2</p> </td> </tr><tr><td width="240" valign="top"><p>&nbsp; 66.85.185.126</p> </td> <td width="240" valign="top"><p>&nbsp; IP</p> </td> <td width="240" valign="top"><p>&nbsp; search[.]webstie[.]net</p> </td> </tr><tr><td width="240" valign="top"><p>&nbsp; dns[.]domain-resolve[.]org</p> </td> <td width="240" valign="top"><p>&nbsp; Domain</p> </td> <td width="240" valign="top"><p>&nbsp; C2</p> </td> </tr><tr><td width="240" valign="top"><p>&nbsp; X:\Project\BotFrame\Debug\Client.pdb</p> </td> <td width="240" valign="top"><p>&nbsp; PDB</p> </td> <td width="240" valign="top"><p>&nbsp; PDB Path</p> </td> </tr><tr><td width="240" valign="top"><p>&nbsp; ntdata.tmp</p> </td> <td width="240" valign="top"><p>&nbsp; File</p> </td> <td width="240" valign="top"><p>&nbsp; Packet capture output</p> </td> </tr><tr><td width="240" valign="top"><p>&nbsp; Core Networking - Router Solicitation</p> </td> <td width="240" valign="top"><p>&nbsp; Windows Firewall Rule</p> </td> <td width="240" valign="top"><p>&nbsp; 7fd5…</p> </td> </tr></tbody></table> <h2>&nbsp;</h2> <h2>MITRE</h2> <table border="1" cellspacing="0" cellpadding="0"> <tbody><tr><td width="186" valign="top"><p><b>&nbsp; Tactic</b></p> </td> <td width="59" valign="top"><p><b>&nbsp; ID</b></p> </td> <td width="217" valign="top"><p><b>&nbsp; Name</b></p> </td> <td width="257" valign="top"><p><b>&nbsp; Notes</b></p> </td> </tr><tr><td width="186" rowspan="3"><p>&nbsp; Discovery</p> </td> <td width="59" valign="top"><p>&nbsp;&nbsp;<a href="https://attack.mitre.org/techniques/T1040/" target="_blank">T1040</a></p> </td> <td width="217" valign="top"><p>&nbsp; Network Sniffing</p> </td> <td width="257" valign="top"><p>&nbsp; Sniffs packets and saves to file</p> </td> </tr><tr><td width="59" valign="top"><p>&nbsp;&nbsp;<a href="https://attack.mitre.org/techniques/T1046/" target="_blank">T1046</a></p> </td> <td width="217" valign="top"><p>&nbsp; Network Service Scanning</p> </td> <td width="257" valign="top"><p>&nbsp; ARP/SMB</p> </td> </tr><tr><td width="59" valign="top"><p>&nbsp;&nbsp;<a href="https://attack.mitre.org/techniques/T1082/" target="_blank">T1082</a></p> </td> <td width="217" valign="top"><p>&nbsp; System Information Discovery</p> </td> <td width="257" valign="top"><p>&nbsp; User/computer name, system directory and workstation information</p> </td> </tr><tr><td width="186" rowspan="3"><p>&nbsp; Command and Control</p> </td> <td width="59" valign="top"><p>&nbsp;&nbsp;<a href="https://attack.mitre.org/techniques/T1043/" target="_blank">T1043</a></p> </td> <td width="217" valign="top"><p>&nbsp; Commonly Used Port</p> </td> <td width="257" valign="top"><p>&nbsp; HTTP/HTTPS</p> </td> </tr><tr><td width="59" valign="top"><p>&nbsp;&nbsp;<a href="https://attack.mitre.org/techniques/T1065/" target="_blank">T1065</a></p> </td> <td width="217" valign="top"><p>&nbsp; Uncommonly Used Port</p> </td> <td width="257" valign="top"><p>&nbsp; 65000 - 65536</p> </td> </tr><tr><td width="59" valign="top"><p>&nbsp;&nbsp;<a href="https://attack.mitre.org/techniques/T1001/" target="_blank">T1001</a></p> </td> <td width="217" valign="top"><p>&nbsp; Data Obfuscation</p> </td> <td width="257" valign="top"><p>&nbsp; RSA/AES C2 encryption</p> </td> </tr><tr><td width="186" valign="top"><p>&nbsp; Impact</p> </td> <td width="59" valign="top"><p>&nbsp;&nbsp;<a href="https://attack.mitre.org/techniques/T1493/" target="_blank">T1493</a></p> </td> <td width="217" valign="top"><p>&nbsp; Transmitted Data Manipulation</p> </td> <td width="257" valign="top"><p>&nbsp; Performs packet interception, modification and retransmission</p> </td> </tr></tbody></table> <p><i>&nbsp;</i></p> </div>
    
    
</div>


    
    
    <div class="authorblog"><!--Pulling author bio from author page-->

    
    
        
  



<div class="author-info" data-author-name="The BlackBerry Cylance Threat Research Team" data-author-path="https://blogs.blackberry.com/en/2019/07/threat-spotlight-ratsnif-new-network-vermin-from-oceanlotus">
  <div class="author-avatar">
    
    <img src="/content/dam/blogs-blackberry-com/images/blogs/blackberry-blogs/img/generic-profile-image.png" class="author-avatar" alt="The BlackBerry Cylance Threat Research Team"/>				
    
  </div><!-- .author-avatar -->
  <div class="author-description">
      
    
    <h2>About The BlackBerry Cylance Threat Research Team</h2>
    The BlackBerry Cylance Threat Research team examines malware and suspected malware to better identify its abilities, function and attack vectors. Threat Research is on the frontline of information security and often deeply examines malicious software, which puts us in a unique position to discuss never-seen-before threats.<br />
  </div><!-- .author-description	-->
</div>
<hr class="author-hr"/>
    
</div>


    
    
    <div class="socialsharing">

<div class='socialSharing row'>
  <ul class='socialSharing-icons'>
    <li>
        <a href='https://twitter.com/intent/tweet?url=https://blogs.blackberry.com/en/2019/07/threat-spotlight-ratsnif-new-network-vermin-from-oceanlotus&text=Threat%20Spotlight:%20Ratsnif%20-%20New%20Network%20Vermin%20from%20OceanLotus&via=BlackBerry' title="Share on Twitter" target="_blank" class="twitter-share">
        <span class='sr-only sr-only-focusable'>Share on Twitter</span>
        <span class='svgIcon-socialSharing svgIcon-socialSharing--tw' aria-hidden='true'>
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path d="M459.37 151.716c.325 4.548.325 9.097.325 13.645 0 138.72-105.583 298.558-298.558 298.558-59.452 0-114.68-17.219-161.137-47.106 8.447.974 16.568 1.299 25.34 1.299 49.055 0 94.213-16.568 130.274-44.832-46.132-.975-84.792-31.188-98.112-72.772 6.498.974 12.995 1.624 19.818 1.624 9.421 0 18.843-1.3 27.614-3.573-48.081-9.747-84.143-51.98-84.143-102.985v-1.299c13.969 7.797 30.214 12.67 47.431 13.319-28.264-18.843-46.781-51.005-46.781-87.391 0-19.492 5.197-37.36 14.294-52.954 51.655 63.675 129.3 105.258 216.365 109.807-1.624-7.797-2.599-15.918-2.599-24.04 0-57.828 46.782-104.934 104.934-104.934 30.213 0 57.502 12.67 76.67 33.137 23.715-4.548 46.456-13.32 66.599-25.34-7.798 24.366-24.366 44.833-46.132 57.827 21.117-2.273 41.584-8.122 60.426-16.243-14.292 20.791-32.161 39.308-52.628 54.253z"/></svg>
        </span>
      </a>
    </li>    
    <li>
      <a href='https://www.facebook.com/sharer/sharer.php?u=https://blogs.blackberry.com/en/2019/07/threat-spotlight-ratsnif-new-network-vermin-from-oceanlotus' title="Share on FaceBook" target="_blank" class="facebook-share">
        <span class='sr-only sr-only-focusable'>Share on Facebook</span>
        <span class='svgIcon-socialSharing svgIcon-socialSharing--fb' aria-hidden='true'>
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 264 512"><path d="M76.7 512V283H0v-91h76.7v-71.7C76.7 42.4 124.3 0 193.8 0c33.3 0 61.9 2.5 70.2 3.6V85h-48.2c-37.8 0-45.1 18-45.1 44.3V192H256l-11.7 91h-73.6v229"/></svg>
        </span>
      </a>
    </li>
    <li>
      <a href="https://www.linkedin.com/shareArticle?mini=true&url=https://blogs.blackberry.com/en/2019/07/threat-spotlight-ratsnif-new-network-vermin-from-oceanlotus&title=Threat%20Spotlight:%20Ratsnif%20-%20New%20Network%20Vermin%20from%20OceanLotus&summary=&source=blogs.blackberry.com" title="Share on LinkedIn" target="_blank" class="linkedin-share">
        <span class='sr-only sr-only-focusable'>Share on Linked In</span>
        <span class='svgIcon-socialSharing svgIcon-socialSharing--li' aria-hidden='true'>
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448.1 512"><path d="M100.3 448H7.4V148.9h92.9V448zM53.8 108.1C24.1 108.1 0 83.5 0 53.8S24.1 0 53.8 0s53.8 24.1 53.8 53.8-24.1 54.3-53.8 54.3zM448 448h-92.7V302.4c0-34.7-.7-79.2-48.3-79.2-48.3 0-55.7 37.7-55.7 76.7V448h-92.8V148.9h89.1v40.8h1.3c12.4-23.5 42.7-48.3 87.9-48.3 94 0 111.3 61.9 111.3 142.3V448h-.1z"/></svg>
        </span>
      </a>
    </li>
    <li>
      <a href="mailto:?subject=Threat%20Spotlight:%20Ratsnif%20-%20New%20Network%20Vermin%20from%20OceanLotus&body=https://blogs.blackberry.com/en/2019/07/threat-spotlight-ratsnif-new-network-vermin-from-oceanlotus" title="Email" class="email-share">
        <span class='sr-only sr-only-focusable'>Email</span>
        <span class='svgIcon-socialSharing svgIcon-socialSharing--li' aria-hidden='true'>
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path d="M502.3 190.8c3.9-3.1 9.7-.2 9.7 4.7V400c0 26.5-21.5 48-48 48H48c-26.5 0-48-21.5-48-48V195.6c0-5 5.7-7.8 9.7-4.7 22.4 17.4 52.1 39.5 154.1 113.6 21.1 15.4 56.7 47.8 92.2 47.6 35.7.3 72-32.8 92.3-47.6 102-74.1 131.6-96.3 154-113.7zM256 320c23.2.4 56.6-29.2 73.4-41.4 132.7-96.3 142.8-104.7 173.4-128.7 5.8-4.5 9.2-11.5 9.2-18.9v-19c0-26.5-21.5-48-48-48H48C21.5 64 0 85.5 0 112v19c0 7.4 3.4 14.3 9.2 18.9 30.6 23.9 40.7 32.4 173.4 128.7 16.8 12.2 50.2 41.8 73.4 41.4z"/></svg>
        </span>
      </a>
    </li>    
  </ul>
</div>
</div>


    
    
    <div class="backbutton">
<a href="javascript:history.back()" class="cta cta-primary btn-back-button">Back</a></div>



      </div>
      
          
      </div>
    </section>
      
  
  
</div>



</main>

<!-- BEGIN DO NOT INDEX -->
<footer>
    <div class="container pt-2">
    <nav id='footerNav'>
        <div>
            <div class="row my-4">
                <div class='socialLinks col-lg-4 col-md-4 col-sm-12 pb-3'>
                    <a href='https://www.facebook.com/BlackBerry/' class='socialLink px-3 pl-0' target="_blank" rel="noopener" style="padding-left:0 !important;">
                      <span class='sr-only' aria-label="BlackBerry Facebook Account">Facebook</span>
                      <span class='svgIcon-social fb' aria-hidden="true">
                        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M448 56.7v398.5c0 13.7-11.1 24.7-24.7 24.7H309.1V306.5h58.2l8.7-67.6h-67v-43.2c0-19.6 5.4-32.9 33.5-32.9h35.8v-60.5c-6.2-.8-27.4-2.7-52.2-2.7-51.6 0-87 31.5-87 89.4v49.9h-58.4v67.6h58.4V480H24.7C11.1 480 0 468.9 0 455.3V56.7C0 43.1 11.1 32 24.7 32h398.5c13.7 0 24.8 11.1 24.8 24.7z"/>
                        </svg>
                      </span>
                    </a>
                    <a href='https://twitter.com/blackberry' target="_blank" class='socialLink px-3 ' rel="noopener">
                      <span class='sr-only' aria-label="BlackBerry Twitter Account">Twitter</span>
                      <span class='svgIcon-social tw'>
                        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path d="M459.37 151.716c.325 4.548.325 9.097.325 13.645 0 138.72-105.583 298.558-298.558 298.558-59.452 0-114.68-17.219-161.137-47.106 8.447.974 16.568 1.299 25.34 1.299 49.055 0 94.213-16.568 130.274-44.832-46.132-.975-84.792-31.188-98.112-72.772 6.498.974 12.995 1.624 19.818 1.624 9.421 0 18.843-1.3 27.614-3.573-48.081-9.747-84.143-51.98-84.143-102.985v-1.299c13.969 7.797 30.214 12.67 47.431 13.319-28.264-18.843-46.781-51.005-46.781-87.391 0-19.492 5.197-37.36 14.294-52.954 51.655 63.675 129.3 105.258 216.365 109.807-1.624-7.797-2.599-15.918-2.599-24.04 0-57.828 46.782-104.934 104.934-104.934 30.213 0 57.502 12.67 76.67 33.137 23.715-4.548 46.456-13.32 66.599-25.34-7.798 24.366-24.366 44.833-46.132 57.827 21.117-2.273 41.584-8.122 60.426-16.243-14.292 20.791-32.161 39.308-52.628 54.253z"/></svg>
                      </span>
                    </a>
                    <a href='https://www.youtube.com/user/BlackBerry' target="_blank" class='socialLink px-3' rel="noopener">
                      <span class='sr-only' aria-label="BlackBerry YouTube Account">YouTube</span>
                      <span class='svgIcon-social yt'>
                        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 576 512"><path d="M549.655 124.083c-6.281-23.65-24.787-42.276-48.284-48.597C458.781 64 288 64 288 64S117.22 64 74.629 75.486c-23.497 6.322-42.003 24.947-48.284 48.597-11.412 42.867-11.412 132.305-11.412 132.305s0 89.438 11.412 132.305c6.281 23.65 24.787 41.5 48.284 47.821C117.22 448 288 448 288 448s170.78 0 213.371-11.486c23.497-6.321 42.003-24.171 48.284-47.821 11.412-42.867 11.412-132.305 11.412-132.305s0-89.438-11.412-132.305zm-317.51 213.508V175.185l142.739 81.205-142.739 81.201z"/></svg>
                      </span>                      
                    </a>
                    <a href='https://www.instagram.com/blackberry/' target="_blank" class='socialLink youTube px-3' rel="noopener">
                      <span class='sr-only' aria-label="BlackBerry Instagram Account">Instagram</span>
                      <span class='svgIcon-social ig'>
                        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M224.1 141c-63.6 0-114.9 51.3-114.9 114.9s51.3 114.9 114.9 114.9S339 319.5 339 255.9 287.7 141 224.1 141zm0 189.6c-41.1 0-74.7-33.5-74.7-74.7s33.5-74.7 74.7-74.7 74.7 33.5 74.7 74.7-33.6 74.7-74.7 74.7zm146.4-194.3c0 14.9-12 26.8-26.8 26.8-14.9 0-26.8-12-26.8-26.8s12-26.8 26.8-26.8 26.8 12 26.8 26.8zm76.1 27.2c-1.7-35.9-9.9-67.7-36.2-93.9-26.2-26.2-58-34.4-93.9-36.2-37-2.1-147.9-2.1-184.9 0-35.8 1.7-67.6 9.9-93.9 36.1s-34.4 58-36.2 93.9c-2.1 37-2.1 147.9 0 184.9 1.7 35.9 9.9 67.7 36.2 93.9s58 34.4 93.9 36.2c37 2.1 147.9 2.1 184.9 0 35.9-1.7 67.7-9.9 93.9-36.2 26.2-26.2 34.4-58 36.2-93.9 2.1-37 2.1-147.8 0-184.8zM398.8 388c-7.8 19.6-22.9 34.7-42.6 42.6-29.5 11.7-99.5 9-132.1 9s-102.7 2.6-132.1-9c-19.6-7.8-34.7-22.9-42.6-42.6-11.7-29.5-9-99.5-9-132.1s-2.6-102.7 9-132.1c7.8-19.6 22.9-34.7 42.6-42.6 29.5-11.7 99.5-9 132.1-9s102.7-2.6 132.1 9c19.6 7.8 34.7 22.9 42.6 42.6 11.7 29.5 9 99.5 9 132.1s2.7 102.7-9 132.1z"/></svg>
                      </span>                        
                    </a>
                                 
                  </div>
                
<!--                  <div class="col-lg-4  col-md-4 col-sm-12 pb-3" data-sly-test="true">-->
<!--                    <a href="https://www.blackberry.com/us/en/forms/enterprise/contact-us" target="_blank" style="color:black; font-size: 16px;">Contact Us</a>-->
<!--                  </div>-->
<!--                <div class="col-lg-4  col-md-4 col-sm-12 pb-3" data-sly-test="false">-->
<!--                    <a href="https://www.blackberry.com/ja/jp/forms/enterprise/contact-us" target="_blank" style="color:black; font-size: 16px;">Contact Us</a>-->
<!--                </div>-->
<!--                  <div class="col-lg-4  col-md-4 col-sm-12 pb-3" data-sly-test="true">-->
<!--                    <a href="https://www.blackberry.com/us/en/support" target="_blank" style="color: black; font-size: 16px;">Support</a>-->
<!--                  </div>-->
<!--                <div class="col-lg-4  col-md-4 col-sm-12 pb-3" data-sly-test="false">-->
<!--                    <a href="https://www.blackberry.com/ja/jp/support/overview" target="_blank" style="color: black; font-size: 16px;">Support</a>-->
<!--                </div>-->
            </div>
            <hr/>
            <div class='row mt-5'>
               <!--/% <div class='col-xs-12 col-md-3'>
                   
                    <sly data-sly-list.col1="">
                        
                          <a class="footerCollapse" role="button" data-toggle="collapse" href="#collapse1" aria-expanded="false" aria-controls="collapse1">
                          	<h3>
                              <span class='open'>
                                  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M207.029 381.476L12.686 187.132c-9.373-9.373-9.373-24.569 0-33.941l22.667-22.667c9.357-9.357 24.522-9.375 33.901-.04L224 284.505l154.745-154.021c9.379-9.335 24.544-9.317 33.901.04l22.667 22.667c9.373 9.373 9.373 24.569 0 33.941L240.971 381.476c-9.373 9.372-24.569 9.372-33.942 0z"/></svg>
                              </span>
                              <span class='closed'>
                                  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M240.971 130.524l194.343 194.343c9.373 9.373 9.373 24.569 0 33.941l-22.667 22.667c-9.357 9.357-24.522 9.375-33.901.04L224 227.495 69.255 381.516c-9.379 9.335-24.544 9.317-33.901-.04l-22.667-22.667c-9.373-9.373-9.373-24.569 0-33.941L207.03 130.525c9.372-9.373 24.568-9.373 33.941-.001z"/></svg>
                              </span> 
                            </h3>
                          </a>
                          
                        <sly data-sly-list.children="">
                        	<div class="collapse in" id="collapse1">
                            <ul data-sly-list.leveltwo="">
                                <li>
                                    <sly data-sly-use.navLink="Footer">
                                        <sly data-sly-test="">
                                            <a href="" data-sly-attribute.target=""></a>
                                        </sly>
                                        <sly data-sly-test="true">
                                            <a href="" data-sly-attribute.target="" rel="noopener"></a>
                                        </sly>
                                    </sly>
                                </li>
                            </ul>
                            </div>
                        </sly>
                    </sly>
                </div>
%/-->
                <div class='col-xs-12 col-md-4'>
                    <!--Col-2-->
                    
                        <a class="footerCollapse" role="button" data-toggle="collapse" href="#collapse21" aria-expanded="false" aria-controls="collapse21">
                        	<h3>Corporate
                              <span class='open'>
                                  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M207.029 381.476L12.686 187.132c-9.373-9.373-9.373-24.569 0-33.941l22.667-22.667c9.357-9.357 24.522-9.375 33.901-.04L224 284.505l154.745-154.021c9.379-9.335 24.544-9.317 33.901.04l22.667 22.667c9.373 9.373 9.373 24.569 0 33.941L240.971 381.476c-9.373 9.372-24.569 9.372-33.942 0z"/></svg>
                              </span>
                              <span class='closed'>
                                  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M240.971 130.524l194.343 194.343c9.373 9.373 9.373 24.569 0 33.941l-22.667 22.667c-9.357 9.357-24.522 9.375-33.901.04L224 227.495 69.255 381.516c-9.379 9.335-24.544 9.317-33.901-.04l-22.667-22.667c-9.373-9.373-9.373-24.569 0-33.941L207.03 130.525c9.372-9.373 24.568-9.373 33.941-.001z"/></svg>
                              </span>
                            </h3>
                        </a>
                        
                        	<div class="collapse in" id="collapse21">
                            <ul>
                                <li>
                                    
                                        
                                        
                                            <a href="https://www.blackberry.com/us/en/company" rel="noopener" target="_blank">Company</a>
                                        
                                    
                                </li>
                            
                                <li>
                                    
                                        
                                            <a href="https://www.blackberry.com/us/en/company/newsroom" target="_blank">Newsroom</a>
                                        
                                        
                                    
                                </li>
                            
                                <li>
                                    
                                        
                                            <a href="https://www.blackberry.com/us/en/company/investors" target="_blank">Investors</a>
                                        
                                        
                                    
                                </li>
                            
                                <li>
                                    
                                        
                                        
                                            <a href="https://www.blackberry.com/us/en/company/careers" rel="noopener" target="_blank">Careers</a>
                                        
                                    
                                </li>
                            
                                <li>
                                    
                                        
                                            <a href="https://www.blackberry.com/us/en/company/leadership" target="_blank">Leadership</a>
                                        
                                        
                                    
                                </li>
                            
                                <li>
                                    
                                        
                                            <a href="https://www.blackberry.com/us/en/company/corporate-responsibility-at-blackberry" target="_blank">Corporate Responsibility</a>
                                        
                                        
                                    
                                </li>
                            
                                <li>
                                    
                                        
                                        
                                            <a href="https://www.blackberry.com/us/en/company/certifications" rel="noopener" target="_blank">Certifications</a>
                                        
                                    
                                </li>
                            
                                <li>
                                    
                                        
                                        
                                            <a href="https://www.blackberry.com/us/en/success-stories" rel="noopener" target="_blank">Customer Success</a>
                                        
                                    
                                </li>
                            </ul>
                            </div>
                        
                    
                </div>

                <div class='col-xs-12 col-md-4'>
                    <!--Col-3-->
                    
                    	<a class="footerCollapse" role="button" data-toggle="collapse" href="#collapse31" aria-expanded="false" aria-controls="collapse31">
                        	<h3>Developers
                              <span class='open'>
                                  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M207.029 381.476L12.686 187.132c-9.373-9.373-9.373-24.569 0-33.941l22.667-22.667c9.357-9.357 24.522-9.375 33.901-.04L224 284.505l154.745-154.021c9.379-9.335 24.544-9.317 33.901.04l22.667 22.667c9.373 9.373 9.373 24.569 0 33.941L240.971 381.476c-9.373 9.372-24.569 9.372-33.942 0z"/></svg>
                              </span>
                              <span class='closed'>
                                  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M240.971 130.524l194.343 194.343c9.373 9.373 9.373 24.569 0 33.941l-22.667 22.667c-9.357 9.357-24.522 9.375-33.901.04L224 227.495 69.255 381.516c-9.379 9.335-24.544 9.317-33.901-.04l-22.667-22.667c-9.373-9.373-9.373-24.569 0-33.941L207.03 130.525c9.372-9.373 24.568-9.373 33.941-.001z"/></svg>
                              </span>
                            </h3>
                        </a>
                        
                        	<div class="collapse in" id="collapse31">
                            <ul>
                                <li>
                                    
                                        
                                        
                                            <a href="https://developers.blackberry.com/" rel="noopener" target="_blank">Enterprise Platform &amp; Apps</a>
                                        
                                    
                                </li>
                            
                                <li>
                                    
                                        
                                        
                                            <a href="https://www.qnx.com/account/login.html?returnaddress=%2Fdownload%2Fgroup.html%3Fprogramid%3D29178" rel="noopener" target="_blank">BlackBerry QNX Developer Network</a>
                                        
                                    
                                </li>
                            </ul>
                            </div>
                        
                    
                    	<a class="footerCollapse" role="button" data-toggle="collapse" href="#collapse32" aria-expanded="false" aria-controls="collapse32">
                        	<h3>Blogs
                              <span class='open'>
                                  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M207.029 381.476L12.686 187.132c-9.373-9.373-9.373-24.569 0-33.941l22.667-22.667c9.357-9.357 24.522-9.375 33.901-.04L224 284.505l154.745-154.021c9.379-9.335 24.544-9.317 33.901.04l22.667 22.667c9.373 9.373 9.373 24.569 0 33.941L240.971 381.476c-9.373 9.372-24.569 9.372-33.942 0z"/></svg>
                              </span>
                              <span class='closed'>
                                  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M240.971 130.524l194.343 194.343c9.373 9.373 9.373 24.569 0 33.941l-22.667 22.667c-9.357 9.357-24.522 9.375-33.901.04L224 227.495 69.255 381.516c-9.379 9.335-24.544 9.317-33.901-.04l-22.667-22.667c-9.373-9.373-9.373-24.569 0-33.941L207.03 130.525c9.372-9.373 24.568-9.373 33.941-.001z"/></svg>
                              </span>
                            </h3>
                        </a>
                        
                        	<div class="collapse in" id="collapse32">
                            <ul>
                                <li>
                                    
                                        
                                        
                                            <a href="https://blogs.blackberry.com/" rel="noopener">BlackBerry ThreatVector Blog</a>
                                        
                                    
                                </li>
                            
                                <li>
                                    
                                        
                                        
                                            <a href="https://devblog.blackberry.com/" rel="noopener" target="_blank">Developers Blog</a>
                                        
                                    
                                </li>
                            
                                <li>
                                    
                                        
                                        
                                            <a href="https://helpblog.blackberry.com/" rel="noopener" target="_blank">Help Blog</a>
                                        
                                    
                                </li>
                            </ul>
                            </div>
                        
                    
                </div>

                <div class='col-xs-12 col-md-4'>
                    <!--Col-4-->
                    
                        <a class="footerCollapse" role="button" data-toggle="collapse" href="#collapse41" aria-expanded="false" aria-controls="collapse41">
                        	<h3>Legal
                              <span class='open'>
                                  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M207.029 381.476L12.686 187.132c-9.373-9.373-9.373-24.569 0-33.941l22.667-22.667c9.357-9.357 24.522-9.375 33.901-.04L224 284.505l154.745-154.021c9.379-9.335 24.544-9.317 33.901.04l22.667 22.667c9.373 9.373 9.373 24.569 0 33.941L240.971 381.476c-9.373 9.372-24.569 9.372-33.942 0z"/></svg>
                              </span>
                              <span class='closed'>
                                  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M240.971 130.524l194.343 194.343c9.373 9.373 9.373 24.569 0 33.941l-22.667 22.667c-9.357 9.357-24.522 9.375-33.901.04L224 227.495 69.255 381.516c-9.379 9.335-24.544 9.317-33.901-.04l-22.667-22.667c-9.373-9.373-9.373-24.569 0-33.941L207.03 130.525c9.372-9.373 24.568-9.373 33.941-.001z"/></svg>
                              </span>
                            </h3>
                        </a>
                        
                        	<div class="collapse in" id="collapse41">
                            <ul>
                                <li>
                                    
                                        
                                            <a href="https://www.blackberry.com/us/en/legal" target="_blank">Overview</a>
                                        
                                        
                                    
                                </li>
                            
                                <li>
                                    
                                        
                                            <a href="https://www.blackberry.com/us/en/legal/accessibility" target="_blank">Accessibility</a>
                                        
                                        
                                    
                                </li>
                            
                                <li>
                                    
                                        
                                            <a href="https://www.blackberry.com/us/en/legal/blackberry-virtual-patent-marking" target="_blank">Patents</a>
                                        
                                        
                                    
                                </li>
                            
                                <li>
                                    
                                        
                                            <a href="https://www.blackberry.com/us/en/legal/trademarks" target="_blank">Trademarks</a>
                                        
                                        
                                    
                                </li>
                            
                                <li>
                                    
                                        
                                            <a href="https://www.blackberry.com/us/en/legal/privacy-policy" target="_blank">Privacy Policy</a>
                                        
                                        
                                    
                                </li>
                            </ul>
                            </div>
                        
                    
            </div>
            </div>
        </div>
        <div class='container'>
            <div class='row tm10' style="padding-top: 50px">
                <div class='col-xs-12 col-md-6 copyright' copyright>
                    <p>
                        © 2023 BlackBerry Limited. All rights reserved.
                    </p>
                </div>
              
                
            </div>
        </div>

    </nav>
    </div>
</footer>
<!-- END DO NOT INDEX -->
            
    
    
    
    
<script src="/etc.clientlibs/shared/clientlibs/jquery.min.c4de22c2db1dbe5fe0380215f514281f.js"></script>
<script src="/etc.clientlibs/blogs-bbcom/clientlibs/clientlib-dependencies.min.d41d8cd98f00b204e9800998ecf8427e.js"></script>





    
    
<script src="/etc.clientlibs/blogs-bbcom/clientlibs/clientlib-site.min.051af74c01f479cbe32112beb4547859.js"></script>




    

    

    
    
    

            

            
            <script type="text/plain" class="optanon-category-C0002">

  (function () {

    var getParameterByName = function (name, url) {
      if (!url) url = window.location.href;
      name = name.replace(/[\[\]]/g, '\\$&');
      var regex = new RegExp('[?&]' + name + '(=([^&#]*)|&|#|$)'),
        results = regex.exec(url);
      if (!results) return null;
      if (!results[2]) return '';
      return decodeURIComponent(results[2].replace(/\+/g, ' '));
    }
    var getParentAnchor = function (element) {

      while (element !== null && !(element instanceof HTMLDocument)) {
        if (element.tagName.toUpperCase() === "A") {
          return element;
        }
        element = element.parentNode;
      }
      return null;
    };

    if (document.title === '404') {
        _satellite.track("error",
        { "errorType": "404", "pageURL": document.location.href }
      );
    }

    document.addEventListener('click', function (event) {
      var downloadFiles = [".pdf", ".exe", ".zip",".gzip",".gz",".tar",".jar",".bin",".dmg",".tgz",".mp4"];
      var videoSourceFound = "";
      var elem = getParentAnchor(event.target);
      var audioPlayerButton;
      var audioPlayerButtonChild;
      if (elem !== null) {
        var urlSplit = elem.href.split("/");
        if (elem.matches("a.twitter-share") || elem.matches("a.facebook-share") || elem.matches("a.linkedin-share") || elem.matches("a.email-share")) {
            _satellite.track("social_share",
              { "socialName": elem.className.split('-')[0] }
            );
        }
        else if (elem.hasAttribute("data-lity")) {
          var videoSources = { scene7: "s7d2.scene7.com", youtube: ["youtu.be", "youtube.com"], vimeo: "vimeo.com" };
          for (var key in videoSources) {
            if (videoSources.hasOwnProperty(key)) {
              if (Array.isArray(videoSources[key])) {
                videoSources[key].forEach(function (domain, i) {
                  if (elem.href.indexOf(domain) > -1) {
                    videoSourceFound = key;
                  }
                });

              } else {
                if (elem.href.indexOf(videoSources[key]) > -1) {
                  videoSourceFound = key;
                }
              }
            }
          }
          if (videoSourceFound !== "") {
            var linkHref = videoSourceFound === "scene7" ? getParameterByName("asset",elem.href): elem.href;
              _satellite.track("video", {
                "linkHref": linkHref,
                "videoPlatform": videoSourceFound,
                "linkText": elem.text.trim()
              });
          }

        }
        else if (elem.text.toLowerCase().indexOf("subscribe") > -1 || elem.text.toLowerCase().indexOf("register for updates") > -1) {
            _satellite.track("subscribe",
              { "linkText": elem.text.trim() }
            );
        }
        else if (elem.text.toLowerCase().indexOf("contact us") > -1 || elem.text.toLowerCase().indexOf("contact sales") > -1) {
            _satellite.track("contact_us",
              { "linkText": elem.text.trim() }
            );
        }
        else if (!(elem.host.indexOf(window.location.host) > -1) && elem.href !== "" && videoSourceFound == "") {
            _satellite.track("site_exit", {
              "site": elem.hostname
            });
        }

        for (var i = 0; i < downloadFiles.length; i++) {
          if (elem.href.toLowerCase().indexOf(downloadFiles[i]) > -1) {
            var fileName = urlSplit[urlSplit.length - 1];
            console.log('Download clicked');
              _satellite.track("download",
                { "fileName": fileName }
              );
          }
        }
      }
      else {
        //AA Tracking for Audio Player Component - CM 2/9/2022
        if (event.target.matches('.bb-dms7-audio-container-right__top-playpause') || event.target.matches('#playpauseIcon')) { 
          
          var eventType;
          var audioComponent = $('.audio')[0];
          var audioSource = $($(audioComponent).find('#player source')[0]).attr('src');
          var audioTitle = $($(audioComponent).find('.bb-dms7-audio-container-right__top-info__podcast-name')[0]).text();
          var trackTitle = $($(audioComponent).find('.bb-dms7-audio-container-right__top-info__episode-title')[0]).text();

          if (event.target.matches('.bb-dms7-audio-container-right__top-playpause')) {
            if (event.target.childNodes[0].nextElementSibling.matches('.fa-play')) {
              eventType = 'pause';
            }
            else if (event.target.childNodes[0].nextElementSibling.matches('.fa-pause')) {
              eventType = 'play';
            }
          }
          else if (event.target.matches('#playpauseIcon')) {
            if (event.target.matches('.fa-play')) {
              eventType = 'pause';
            }
            else if (event.target.matches('.fa-pause')) {
              eventType = 'play';
            }
          }

          if (typeof _satellite !== 'undefined') {
              _satellite.track("audio", {
                "eventType": eventType,
                "audioTitle": audioTitle,
                "trackTitle": trackTitle,
                "audioSource": audioSource
              });
          }
        }
      }
    }, false);


  })();


</script>



<script>
    function getGclidQueryParameter(p) {
      var match = RegExp('[?&]' + p + '=([^&]*)').exec(window.location.search);
      return match && decodeURIComponent(match[1].replace(/\+/g, ' '));
    }

    function getExpiryRecord(value) {
      var expiryPeriod = 90 * 24 * 60 * 60 * 1000; // 90 day expiry in milliseconds

      var expiryDate = new Date().getTime() + expiryPeriod;
      return {
        value: value,
        expiryDate: expiryDate
      };
    }

    function addGclid() {
      var gclidParam = getGclidQueryParameter('gclid');
      var gclidFormFields = ['gclid_field']; // all possible gclid form field ids here
      var gclidRecord = null;
      var currGclidFormField;

      var gclsrcParam = getGclidQueryParameter('gclsrc');
      var isGclsrcValid = !gclsrcParam || gclsrcParam.indexOf('aw') !== -1;

      gclidFormFields.forEach(function (field) {
        if (document.getElementById(field)) {
          currGclidFormField = document.getElementById(field);
        }
      });

      if (gclidParam && isGclsrcValid) {
        gclidRecord = getExpiryRecord(gclidParam);
        localStorage.setItem('gclid', JSON.stringify(gclidRecord));
      }

      var gclid = gclidRecord || JSON.parse(localStorage.getItem('gclid'));
      var isGclidValid = gclid && new Date().getTime() < gclid.expiryDate;

      if (currGclidFormField && isGclidValid) {
        currGclidFormField.value = gclid.value;
      }
    }

    window.addEventListener('load', addGclid);
  </script>
        
    </body>
</html>
